{% extends 'base.html' %}
{% load static %}
{% block content %}
<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
  integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
  integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
  integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
  integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
  crossorigin="anonymous" referrerpolicy="no-referrer" />
<style>
  /* #exampleModal{
      z-index: 9999;
      overflow: scroll;
 } */

  td {
    color: rgb(10, 10, 10);
  }

  tr {
    color: rgb(8, 8, 8);
  }

  .modal {
    z-index: 9999;
    overflow: scroll;
  }
</style>
<script>

  function calc() {
    $('#item_table tbody tr').each(function () {



      var html = $(this).html();
      if (html != '') {
        console.log('rows');
        var qty = $(this).find('.qty').val();
        console.log('qty',qty)
        var rate = $(this).find('.rate').val();
        console.log('rate',rate)

        var discount = $(this).find('.discount').val();
        console.log('discount',discount)

        var tax = $(this).find('.tax').val();
        console.log('tax',tax)



       
        $(this).find('.amount').val(qty * rate - discount);
        $(this).find('.taxamount').val((qty * rate - discount) * (tax  / 100));
        var taxamount = parseFloat($(this).find('.taxamount').val());
        console.log('tax_amount:',taxamount)
        console.log(typeof(taxamount))
        calc_total();
      }
    });
  }

  function calc_total() {
    total = 0;
    console.log('hello')

    $('.amount').each(function () {
      total += parseFloat($(this).val());

    });
    taxamount = 0;
    $('.taxamount').each(function () {
      taxamount += parseFloat($(this).val());

    });

    // total = Math.round(total);
    // taxamount = Math.round(taxamount);
    $('#subtotal').val(total.toFixed(2));
    $('#total_taxamount').val(taxamount.toFixed(2));

    $('#total').val((taxamount + total).toFixed(2));
    // $('#baldue').val((taxamount + total).toFixed(2));

    test();
    calculateShippingAndAdjustment();
  }

  function test() {
    console.log('test');
    d = 0;
    var pos = document.getElementById("pos").value;
    var state = document.getElementById("state").value;
    if (pos == state) {
      // console.log(pos);
      // console.log(state);
      // console.log(taxamount);
      gst = taxamount / 2;
      // gst = Math.round (gst);

      console.log(gst);

      $('#cgst').val(parseFloat(gst.toFixed(2)));
      $('#sgst').val(parseFloat(gst.toFixed(2)));
      $('#igst').val(parseFloat(d.toFixed(2)));
      document.getElementById("tr_cgst").style.display = "table-row";
      document.getElementById("tr_sgst").style.display = "table-row";
      document.getElementById('tr_igst').style.display = "none";
      // document.getElementById('tax1').style.display="block";
      // document.getElementById('tax2').style.display="none";

    }

    if (pos != state) {
      // console.log(pos);
      // console.log(state);


      $('#igst').val(taxamount.toFixed(2));
      $('#cgst').val(d.toFixed(2));
      $('#sgst').val(d.toFixed(2));
      document.getElementById('tr_igst').style.display = "table-row";
      document.getElementById("tr_cgst").style.display = "none";
      document.getElementById("tr_sgst").style.display = "none";
      // document.getElementById('tax2').style.display="table-column";
      // document.getElementById('tax1').style.display="none";

    }

  }

  function calculateShippingAndAdjustment() {
        var shipping_charge = parseFloat($('#shipping').val() || 0);
        var adjustment_charge = parseFloat($('#adjustment').val() || 0);
        var subtotal = parseFloat($('#subtotal').val() || 0);
        var total_tax = parseFloat($('#total_taxamount').val() || 0);
        var total = subtotal + total_tax + shipping_charge + adjustment_charge;

        $('#shipping_charge').val(shipping_charge.toFixed(2));
        $('#adjustment_charge').val(adjustment_charge.toFixed(2));
        $('#total').val(total.toFixed(2));
    }

    $(document).ready(function () {
       var pos =document.getElementById("pos").value;
        var state = document.getElementById("state").value;
        if (pos == state) {
            document.getElementById("tr_cgst").style.display = "table-row";
            document.getElementById("tr_sgst").style.display = "table-row";
            document.getElementById('tr_igst').style.display = "none";

        } 
        if (pos != state) {
            
            document.getElementById('tr_igst').style.display = "table-row";
            document.getElementById("tr_cgst").style.display = "none";
            document.getElementById("tr_sgst").style.display = "none";
            

        }
    });
  // Calculate total
  $(document).ready(function () {
    $('#shipping, #adjustment').on('keyup', function () {
      var shipping_charge = parseFloat($('#shipping').val() || 0);
      var adjustment_charge = parseFloat($('#adjustment').val() || 0);
      var subtotal = parseFloat($('#subtotal').val() || 0);
      var total_tax = parseFloat($('#total_taxamount').val() || 0);
      var total = subtotal + total_tax + shipping_charge + adjustment_charge;
      // total = Math.round(total);

      $('#shipping_charge').val(shipping_charge.toFixed(2));
      $('#adjustment_charge').val(adjustment_charge.toFixed(2));
      $('#total').val(total.toFixed(2));
    });
  });






</script>

<script>
  function balabcecheck() {
    console.log('calculation balance');

    var paidrecur = parseFloat($('#paid').val() || 0); // Get the current value of "Paid"
    console.log('paid',paidrecur)
    var totalpaid = parseFloat($('#total').val() || 0);
    console.log('total',totalpaid)

    var bal = totalpaid - paidrecur; // Calculate the balance
    console.log('balance',bal)


    // Update the "Paid" and "Balance" fields with formatted values
    $('#paid').val(paidrecur.toFixed(2));
    $('#blnc').val(bal.toFixed(2));
  }
</script>


<script>
  $(document).ready(function(){
    if (document.getElementById("add").value == '' || document.getElementById("add").value == null) {
            $(".cusadr").addClass('d-none');
          }
          else {
            $(".cusadr").addClass('d-flex');
            $(".cusadr").removeClass('d-none');
          }
    if (document.getElementById("gstr").value == "Unregistered Business-not Registered under GST") {
        $(".gstrow").addClass('d-none');
        }
    else {
        $(".gstrow").addClass('d-flex');
        $(".gstrow").removeClass('d-none');
          }
  })
      $(document).on('change', '#customer_sel', function () {
        var customer = document.getElementById("customer_sel").value
          var na = customer.split(' ')[0];
          console.log(customer)
      $.ajax({
        type: "GET",
        url: "{% url 'get_cust_mail' %}",
        data: {
  
          cust: customer
        },
        success: function (response) {
          console.log(response)
          console.log(response.email)
  
          data = response.email
          // console.log(data)
          data2 = response.ads
          console.log(data2)
          data3 = response.mob
          // console.log(data3)
          data4 = response.gstt
          // console.log(data4)
          data5 = response.gstno
          console.log(data5)
          data6 = response.cust_place_supply
          console.log(data6)
  
          document.getElementById("mail").value = data
          document.getElementById("add").value = data2;
          console.log(document.getElementById("add").value)
          if (data2 == '' || data2 == null) {
            $(".cusadr").addClass('d-none');
          }
          else {
            $(".cusadr").addClass('d-flex');
            $(".cusadr").removeClass('d-none');
          }
          document.getElementById("gstr").value = data4
          document.getElementById("gstnmbr").value = data5
          if (data4 == "Unregistered Business-not Registered under GST") {
            $(".gstrow").addClass('d-none');
          }
          else {
            $(".gstrow").addClass('d-flex');
            $(".gstrow").removeClass('d-none');
          }
          document.getElementById("cpos").innerText = data6;
          document.getElementById("cpos").value = data6;
          // $('#pos').val(data6);
          // $('#pos option:selected').text('data6');
         
          console.log(data4 == "Unregistered Business-not Registered under GST")
          
  
  
        }
      });
    });
  
  </script>
   





<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>



<section>



  <div class="fixed-top  " style="top: 7rem; margin-left: 20rem;">

    <div class="row  ml-2">
      <div class="col-md-3 "><a class="text-white" style="font-size: 1.5rem;">Edit Recurring Invoice</a></div>
      <input type="hidden" id="state" value="{{ company.state }}">

    </div>

    <div style="height: 600px; overflow-y: scroll;">
      <form action="{% url 'editrecurpage' editr.id %}" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <div class="row mb-4 border-top pt-5">
          <div class="col-sm-2"><label for="customer_name" style="margin-left: 10px;">Customer Name*</label></div>
          <div class="col-sm-10">
            <select style="width: 48%; height: 35px;" class="option" name="customer" id="customer_sel">

              <option value="{{editr.cname}}">{{editr.cname}}</option>
                            {% for c in cus %}
                              <option value="{{c.customerName}}">{{c.customerName}}</option>
                            {% endfor %}
            </select>
            <a href="" data-toggle="modal" data-target="#newcustomer"><i class="fa-solid fa-plus p-2 rounded"
                style="color: white; background-color: rgb(210, 132, 30);height: 30px; padding-bottom: 10px;"></i></a>

          </div>
          <div class="row mb-4  pt-3">
            <div class="col-sm-2"><label for="customer_name" style="margin-left: 10px;">Customer Email*</label></div>
            <div class="col-sm-10">
              <input type="text" name="mails" id="mail" value="{{editr.cemail}}" style="width: 50%; height: 35px;">
            </div>
          </div>
          <div class="row cusadr mb-4  pt-3 d-flex">
            <div class="col-sm-2"><label for="customer_name" style="margin-left: 10px;">Customer Address*</label></div>
            <div class="col-sm-10">
              <input type="text" name="addr" id="add" value="{{editr.cadrs}}" style="width: 50%; height: 35px;">
            </div>
          </div>

          <div class="row mb-4  pt-3">
            <div class="col-sm-2"><label for="gst" style="margin-left: 10px; ">GST Treatment*</label></div>
            <div class="col-sm-10">
              <input type="text" name="gst" value="{{editr.gsttr}}" id="gstr" style="width: 50%; height: 35px;">
            </div>
          </div>
          <div class="row gstrow mb-4  pt-3 d-none">
            <div class="col-sm-2"><label for="gstn" style="margin-left: 10px; ">GST Number*</label></div>
            <div class="col-sm-10">
              <input type="text" name="gstnum" value="{{editr.gstnum}}" id="gstnmbr" style="width: 50%; height: 35px;">
            </div>
          </div>
          <div class="row mb-4 pt-3">
            <div class="col-sm-2"><label for="customer_name" style="margin-left: 10px;">Place Of Supply*</label></div>
            <div class="col-sm-10">
              <select name="supply" id="pos" style="width: 50%; height: 35px;">
                <option value="{{editr.p_supply}}" selected>{{editr.p_supply}}</option>

                <option value="Andhra Pradesh">[AD]-Andhra Pradesh</option>
                <option value="Arunachal Pradesh">[AR]-Arunachal Pradesh </option>
                <option value="Assam">[AS]-Assam</option>
                <option value="Bihar">[BR]-Bihar</option>
                <option value="Chandhigarh">[CH]- Chandhigarh</option>
                <option value="Chattisgarh">[CG]- Chattisgarh</option>
                <option value="Daman Diu">[DD]- Daman Diu</option>
                <option value="Delhi">[DL]- Delhi</option>
                <option value="Goa">[GA]-Goa</option>
                <option value="Gujarat">[GJ]-Gujarat</option>
                <option value="Haryana">[HR]-Haryana</option>
                <option value="Himachal Pradesh">[HP]-Himachal Pradesh</option>
                <option value="Jammu And Kashmir">[JK]- Jammu And Kashmir</option>
                <option value="Jharkand">[JH]-Jharkand</option>
                <option value="Karnataka">[KA]-Karnataka</option>
                <option value="Kerala">[KL]-Kerala</option>
                <option value="Ladakh">[LA]-Ladakh</option>
                <option value="Lakshadweep">[LD]-Lakshadweep</option>
                <option value="Madhyapradesh">[MP]-Madhyapradesh</option>
                <option value="Maharashtra">[MH]-Maharashtra</option>
                <option value="Manipur">[MN]-Manipur</option>
                <option value="Meghalaya">[ML]-Meghalaya</option>
                <option value="Mizoram">[MZ]-Mizoram</option>
                <option value="Nagaland">[NL]-Nagaland</option>
                <option value="Nagaland">[NL]-Nagaland</option>
                <option value="Odisha">[OD]-Odisha</option>
                <option value="Puducherry">[PY]-Puducherry</option>
                <option value="Punjab">[PB]-Punjab.</option>
                <option value="Rajasthan">[RL]-Rajasthan</option>
                <option value="Sikkim">[SK]-Sikkim</option>
                <option value="Tamilnadu">[TN]-Tamilnadu</option>
                <option value="Telenghana">[TS]-Telenghana</option>
                <option value="Tripura">[TR]-Tripura</option>
                <option value="Uttar Pradesh">[UP]-Uttar Pradesh</option>
                <option value="Utharakhand">[UK]-Utharakhand</option>
                <option value="West Bengal">[WB]-West Bengal</option>
                <option value="Other Territory">[OT]-Other Territory</option>
              </select>
            </div>
            <div class="row mb-4 pt-3">
              <div class="col-sm-2"><label for="estimate_number" style="margin-left: 10px;">Entry Type</label></div>
              <div class="col-sm-10"><input type="radio" name="type" class="custom-radio"  value="invoice"{% if editr.entry_type == "invoice" %} checked {% endif %}>&nbsp;&nbsp;<label>Invoice</label>&nbsp;&nbsp;&nbsp;&nbsp;
                <input type="radio" name="type" class="custom-radio" value="bill"{% if editr.entry_type == "bill" %} checked {% endif %} >&nbsp;&nbsp;<label>Bill of Supply</label>
              </div>
            </div>
            <div class="row mb-4  pt-3">
              <div class="col-sm-2"><label for="customer_name" style="margin-left: 10px;">Profile Name*</label></div>
              <div class="col-sm-10">
                <input type="text" name="name" value="{{editr.name}}" style="width: 50%; height: 35px;">
              </div>
            </div>
            <div class="row mb-4  pt-3">
              <div class="col-sm-2"><label for="recurinvoice" style="margin-left: 10px;">Invoice Number*</label></div>
              <div class="col-sm-10">
                <input type="text" name="recurno"  value="{{editr.reinvoiceno}}" style="width: 50%; height: 35px;">
              </div>
            </div>
            <div class="row mb-4  pt-3">
              <div class="col-sm-2"><label for="customer_name" style="margin-left: 10px;">Order Number</label></div>
              <div class="col-sm-10">
                <input type="text" name="order" value="{{editr.order_num}}" style="width: 50%; height: 35px;">
              </div>
            </div>
            <div class="row mb-4  pt-3">
              <div class="col-sm-2"><label for="customer_name" style="margin-left: 10px;">Repeat Every *</label></div>
              <div class="col-sm-10">
                <select style="width: 50%; height: 35px;" name="every">
                  <option id="ev_term" selected>{{editr.every}}</option>
                  <option value="2 weeks">2 Weeks</option>
                  <option value="3 months">3 Months</option>
                  <option value="2 years">2 Years</option>
                  {% for e in every %}

                  <option value="{{ e.Terms }}">{{ e.Terms}}</option>
                  {% endfor %}
                </select>
                
                <a  class="btn btn-outline-secondary py-2 my-1" data-target="#repeatevery" data-toggle="modal"
                  style="color: white; background-color: rgb(210, 132, 30);">+</a>
              </div>
            </div>
            <div class="row mb-4  pt-3">
              <div class="col-sm-2"><label for="customer_name" style="margin-left: 10px;">Payment Method*</label></div>
              <div class="col-sm-10">
                <select style="width: 50%; height: 35px;" name="method">
                  <option value="{{editr.payment_method}}">{{editr.payment_method}}</option>

                  <option value="cash">Cash</option>
                  <option value="check">Cheque</option>
                  {% for b in banks %}

                  <option value="{{ b.name }}">{{ b.name }}</option>
                  {% endfor %}
                </select>

              </div>
            </div>
            <div class="row mb-4  pt-3">
              <div class="col-sm-2"><label for="customer_name" style="margin-left: 10px;">Start On</label></div>
              <div class="col-sm-10">
                <input type="date" name="start" id="startd" value="{{editr.start|date:'Y-m-d'}}" style="width: 50%; height: 35px;">
              </div>
            </div>
            <div class="row mb-4 pt-3">
              <div class="col-sm-2"><label for="customer_name" style="margin-left: 10px;">Ends On</label></div>
              <div class="col-sm-10">
                <input type="date" name="end" id="endd" value="{{editr.end|date:'Y-m-d'}}" style="width: 50%; height: 35px;" readonly>
              </div>
            </div>
            <div class="row mb-4  pt-3">
              <div class="col-sm-2"><label for="customer_name" style="margin-left: 10px;">Payment Terms</label></div>
              <div class="col-sm-10">
                <select style="width: 50%; height: 35px;" id="terms" name="terms">
                  if(editr.payment_type=='static'){
                            
                    <option id="crt_term" value="{{editr.terms}}" selected>NET {{editr.terms}}</option>
            }
            else{
                <option value="{{ p.Days }}"> {{ p.Terms}}</option>

            }
            <option value="60" data-source="static">NET 60</option>
            <option value="45" data-source="static">NET 45</option>
            <option value="30" data-source="static">NET 30</option>
            <option value="0" data-source="static">Due On Receipt</option> 
            {% for p in pay %}

                <option value="{{ p.Days }}"data-source="dynamic"> {{ p.Terms}}</option>
            {% endfor %}
                </select>
                <input id="terms_data_source" name="terms_data_source" hidden>
                <a  class="btn btn-outline-secondary py-2 my-1" data-target="#newpayment" data-toggle="modal"
                  style="color: white; background-color: rgb(210, 132, 30);">+</a>

              </div>
            </div>
          </div>




          <div class="row">
            <div class="col-sm-12 col-lg-12 col-md-12 ">

              <label for="" id="label_tab1" class="tab1">Price List</label><br>
              <div style="width: 100%;">
                <table class="table  text-black tab1 " id="item_table"
                  style="background-color: rgba(250, 227, 198, 0.8);" onchange="calc()">
                  <thead>
                    <tr>
                      <th>Item Details <a href="" data-toggle="modal" data-target="#newitem" class="text-capitalize"><i
                            class="fas fa-plus p-2 rounded"
                            style="color: white; background-color: rgb(210, 132, 30);"></i></a></th>
                      <th class="text-right">HSN</th>
                      <th class="text-right">Quantity</th>
                      <th class="text-right">Rate</th>
                      <th class="text-right">Discount</th>
                      <th class="text-right">Tax</th>
                      <th class="text-right">Amount</th>
                    </tr>
                  </thead>
                  <tbody>
                  {% for t in tab %}

                    <tr id='row1{{ forloop.counter }}'>
                      <td>
                        <div class='form-group'><select
                            class='form-control bg-transparent text-black border-0 item_select itm' name='item[]'
                            id='item1{{ forloop.counter }}'>
                            <option class='text-dark' value="{{t.iname}}">{{t.iname}}</option>

                            {% for i in item %}
                            <option class="text" value="{{i.Name}}">{{i.Name}}</option>
                            {% endfor %}
                          </select></div>
                      </td>
                      <td class='text-right'><input type='number' id='hsn1{{ forloop.counter }}'
                        class='bg-transparent border-0 text-black text-right hsn' name='hsn[]' value='{{t.hsncode}}'
                        style="width: 75%;">
                    </td>
                      <td class='text-right'><input type='number' id='qty1{{ forloop.counter }}'
                          class='bg-transparent border-0 text-black text-right qty' name='quantity[]' value='{{t.quantity}}'
                          style="width: 75%;">
                      </td>
                      
                      <td class='text-right'><input type='number' id='rate1{{ forloop.counter }}'
                          class='bg-transparent border-0 text-black text-right rate' name='rate[]' value='{{t.rate}}'
                          style="width: 75%;">
                      </td>
                      <td class='text-right'><input type='number' id='discount1{{ forloop.counter }}'
                          class='bg-transparent border-0 text-black text-right discount' name='discount[]' value='{{t.discount}}'
                          style="width: 75%;">
                      </td>
                      <td class='text-right'>
                        <input type="hidden" name='taxamount' id="taxamount1{{ forloop.counter }}"  class=" taxamount" style="color: black;" />

                        <select name='tax[]' id='tax{{ forloop.counter }}'
                          class='form-control bg-transparent text-black text-right border-0 tax' onclick='handleTaxChange({{ forloop.counter }})'>
                          <option value="{{t.tax}}" selected>{{t.tax}} </option>

                          <optgroup label="GST">
                            <option value=0>0% GST</option>
                            <option value=3>3% GST</option>
                            <option value=5>5% GST</option>
                            <option value=12>12% GST</option>
                            <option value=18>18% GST</option>
                            <option value=28>28% GST</option>
                          </optgroup>
                          <optgroup label="IGST">
                            <option value=0>0% IGST</option>
                            <option value=3>3% IGST</option>
                            <option value=5>5% IGST</option>
                            <option value=12>12% IGST</option>
                            <option value=18>18% IGST</option>
                            <option value=28>28% IGST</option>
                          </optgroup>
                        </select>

                      </td>
                      <!-- <td style="display: none;">
                        <input type="number" name='taxamount[]' id="taxamount1{{ forloop.counter }}" class="taxamount" />
                      </td> -->
                      <td class='text-right'><input type='number' id='amount1{{ forloop.counter }}'
                          class='bg-transparent border-0 text-black text-right amount' name='amount[]' value='{{t.amt}}'
                          style="width: 85%;"></td>
                          

                      <td class='text-center'><button type='button' id='del_btn1'
                          class='btn btn-transparent text-danger btn-sm btn-outline-danger rounded-circle delete-row'
                          style='width:30px'><i class='fa fa-times'></i></button></td>
                    </tr>
                  {% endfor %}
                  </tbody>

                </table>
              </div>
              <button type="button" class="btn btn-sm text-white" style="background-color: rgb(210, 132, 30) ;"
                id="add-row">Add another line</button>
            </div>
          </div>



          <div class="row border-bottom pb-5">
            <div class="col-sm-6 d-flex flex-column mt-auto">

              <label for="">Customer Notes</label>
              <textarea name="customer_note" id="" cols="8" rows="3"
                placeholder=" Will be Displayed on the Estimate">{{editr.cust_note}}</textarea>
            </div>
            <div class="col-sm-6">
              <table class=" table  text-black" style="background-color: rgba(250, 227, 198, 0.8);">
                <tr>
                  <td>Sub Total</td>
                  <td></td>
                  <td><input type="number" id="subtotal" name="subtotal" step="any" value="{{editr.sub_total}}"
                      class="bg-transparent border-0 text-right subtotal" style="color: black;"></td>
                </tr>
                <tr style="display: none;" id="tr_igst">
                  <td>IGST</td>
                  <td></td>
                  <td><input type="number" id='igst' name="igst" step="any" value="{{editr.igst}}"
                      class=" bg-transparent border-0 text-right igst" style="color: black;"></td>
                </tr>
                <tr style="display: none;" id="tr_cgst">
                  <td>CGST</td>
                  <td></td>
                  <td><input type="number" id='cgst' name="cgst" step="any" value="{{editr.cgst}}"
                      class=" bg-transparent border-0 text-right cgst"></td>
                </tr>
                <tr style="display: none;" id="tr_sgst">
                  <td>SGST</td>
                  <td></td>
                  <td><input type="number" id='sgst' name="sgst" step="any" value="{{editr.sgst}}"
                      class=" bg-transparent border-0 text-right sgst" style="color: black;"></td>
                </tr>
                <tr>
                  <td>Tax Amount</td>
                  <td></td>
                  <td><input type="number" id="total_taxamount" name="total_taxamount" step="any" value="{{editr.tax_amount}}"
                      class="total_taxamount  bg-transparent border-0 text-right" style="color: black;"></td>
                </tr>
                <tr>
                  <td>Shipping Charges</td>
                  <td></td>
                  <td><input type="text" id="shipping" name="shipping_charge" step="any" value="{{editr.shipping_charge}}"
                      style="color: black;"></td>
                </tr>
                <tr>
                  <td>Adjustmment</td>
                  <td></td>
                  <td><input type="text" id="adjustment" name="adjustment_charge" step="any" value="{{editr.adjustment}}"
                      style="color: black;"> </td>
                </tr>
                <tr>
                  <th>Total ( &#x20B9; )</th>
                  <th></th>
                  <th><input type="number" id="total" name="total" step="any" value="{{editr.total}}"
                      class=" bg-transparent border-0 text-right total"></th>
                </tr>
                <tr>
                  <td>Paid ( &#x20B9; )</td>
                  <td></td>
                  <td><input type="text" id="paid" name="paids" step="any" value="{{editr.paid}}" style="color: black;"
                      onchange="balabcecheck()"> </td>
                </tr>
                <tr style="display: none;">
                  <td>Balance</td>
                  <td></td>
                  <td><input type="text" id="blnc" name="balance" step="any" value="{{editr.balance}}" style="color: black;"> </td>
                </tr>
              </table>

            </div>
          </div>


          <div class="row ">
            <div class="col-md-8 d-flex flex-column w-60 m text-black">
              <label for="" style="color: white;">Terms & Conditions</label>
              <textarea name="ter_cond" id="" cols="20" rows="5"
                placeholder=" Enter the terms & conditions .">{{editr.conditions}}</textarea>
            </div>

          </div>
          <div class="col-md-6 col-lg-6 col-sm-12 py-5 text-center rounded mt-4">
            <div style="width: 100%;background-color: rgba(243, 241, 241, 0.904);height: 120px;">
              <label class="text-black mt-3 pt-3" for="">Attach File(s) to Recurring Invoice</label><br>

              <label for="file-upload" class="btn text-white border-0" style="background-color: rgb(210, 132, 30);">
                <i class="fas fa-upload text-white"></i> Upload File
              </label>
              <input class="pb-3" id="file-upload" type="file" name="file" style="display:none;">
            </div>
          </div>
        </div>



        <div class="" style="margin-bottom: 20rem;">

          <button type="submit" name="sd" id="edits" class="btn btn-warning text-white" 
                value="Save">Edit</button>
            <input class="btn btn-danger text-white"
                type="reset" value="Cancel">
    </div>
    <script>
$(document).ready(function() {
      // Attach a click event listener to the button
      $('#edits').click(function() {
          // Log a message to the console when the button is clicked
          console.log('Button clicked!');
      });
  });

    </script>
    








    </form>




  </div>



  </div>

  <script>
    $("#terms").on("change" ,function(){
  
          var selectedOption = $("#terms option:selected");
          var type = selectedOption.data("source");
          console.log(type)
          if(type == "static"){
              $("#terms_data_source").val('static')
          }
          else{
              $("#terms_data_source").val('dynamic')
          }
          
      });
      window.onload=function(){
        updateOptionText() 
      }
      function updateOptionText() {
        var selectElement = document.getElementById("terms");
        var selectedValue = selectElement.value;
        var selectedOption = selectElement.options[selectElement.selectedIndex];
        console.log("hi",selectedValue)

        if (selectedValue === "0") {
            selectedOption.text = "Due On Receipt";
        } else {
            // selectedOption.text = selectedValue;
        }
    }
  </script>



  <script>
    $(document).on('keyup', "#paid", function () {
      var grandtotal = parseFloat($("#total").val()) || 0;
      var paidAmount = parseFloat($("#paid").val()) || 0;
      //    $('#balance').val((grandtotal - paidAmount).toFixed(2));
      if (paidAmount > grandtotal) {

        alert("Paid amount cannot be greater than the  total.")
        $("#paid").val(grandtotal.toFixed(2));
        $('#blnc').val("0.00");

      } else
        $('#blnc').val(($('#total').val() - paidAmount).toFixed(2));

    });
  </script>


</section>
<!-- customer -->
<div class="modal fade" id="newcustomer">
  <div class="modal-dialog modal-xl">
    <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
      <div class="modal-header " style="background: rgb(32, 35, 37);">
          <h3 class="m-3 text-uppercase">New Customer</h3>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
          </button>
      </div>
      <div class="modal-body" style="background: rgb(32, 35, 37);">
        <div class="card p-3 m-3">
          <form action="" method="post" class="needs-validation"  id="modalCustomer">
            {% csrf_token %}
    
            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="">Customer Type</label><br>
              </div>
              <div class="col-md-6 mt-2">
                <div class="d-flex">
                  <div class="radio_opt mx-5 mt-2">
                    <input type="radio" id="business" name="radioCust" value="Business" >
                    <label for="option1">Business</label>
                  </div>
                  <div class="radio_opt mx-4 mt-2">
                    <input type="radio" id="individual" name="radioCust" value="Individual" >
                    <label for="option2">Individual</label>
                  </div>
                </div>
              </div>
            </div>
            <div class="row mt-5">
              <div class="col-md-3">
                <label for="ctitle">Title</label>
              </div>
              <div class="col-md-3">
                <select name="ctitle" id="ctitle" class="form-control text-dark bg-light">
                  <option value="Mr." selected>Mr.</option>
                  <option value="Mrs.">Mrs.</option>
                  <option value="Ms.">Ms.</option>
                  <option value="Miss.">Miss.</option>
                  <option value="Dr.">Dr.</option>
                </select>
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="cfname">First name</label>
              </div>
              <div class="col-md-6 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="cfname" name="cfirstname" required>
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="clname">Last name</label>
                <label for="cdisplayname" name = "cdisplayname" hidden></label>
              </div>
              <div class="col-md-6 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="clname" name="clastname">
                <input type="hidden"  id="cdisplayname" name="cdisplayname">
              </div>
            </div>

            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="ccompany">Company Name</label>
              </div>
              <div class="col-md-6 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="ccompany" name="ccompany_name">
              </div>
            </div>

            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="cemail">Customer Email</label>
              </div>
              <div class="col-md-6 mt-2">
                <input type="email" class="form-control text-dark bg-light" id="cemail" name="cemail" placeholder="example@gmail.com" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}$">    
              </div>              
            </div>

            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="email">Customer Phone</label>
              </div>
              <div class="col-md-3 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="cw_mobile" placeholder="Work Number" maxlength="10" name="cw_mobile">
              </div>        
              <div class="col-md-3 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="cp_mobile" placeholder="Personal Number" maxlength="10" name="cp_mobile">
              </div>          
            </div>

       
            <hr>
            <center><h4 class="text-uppercase mb-3"><b>Other Details</b></h4></center>
            <div class="row mt-5">
              <div class="col-md-3 mt-2">
                <label for="facebook">Facebook</label>
              </div>
              <div class="col-md-6 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="facebook" placeholder="www.example.com" name="facebook">
              </div>       
            </div>
            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="twitter">Twitter</label>
              </div>
              <div class="col-md-6 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="twitter" placeholder="www.example.com" name="twitter">
              </div>       
            </div>


            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="website">Website</label>
              </div>
              <div class="col-md-6 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="website" placeholder="www.example.com" name="website">
              </div>       
            </div>

            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="cskype">Skype name/Number</label>
              </div>
              <div class="col-md-6 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="cskype" name="cskype">
              </div>       
            </div>

            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="c_desg">Designation</label>
              </div>
              <div class="col-md-6 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="c_desg" name="c_desg">
              </div>       
            </div>

            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="c_dpt">Department</label>
              </div>
              <div class="col-md-6 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="c_dpt" name="c_dpt">
              </div>       
            </div>

            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="c_gsttype" style="color:rgb(190, 88, 88);">GST Treatment *</label>
              </div>
              <div class="col-md-6 mt-2">
                <select class="form-control text-dark bg-light" id="c_gsttype" name="c_gsttype" required>
                  <option value="value" selected>Select a Gst Treatment</option>
                  <option value="Registered Business-Regular Business that is registered under GST">Registered Business-Regular Business that is registered under GST</option>
                  <option value="Registered Business-Composition Business that is registered under the Composition scheme in GST">Registered Business-Composition Business that is registered under the Composition scheme in GST</option>
                  <option value="Unregistered Business-not Registered under GST">Unregistered Business-not Registered under GST</option>
                  <option value="Consumer- A customer who is a regular Consumer">Consumer- A customer who is a regular Consumer</option>
                  <option value="Overseas- Persons with who you do import or exports of supplies outside india">Overseas- Persons with who you do import or exports of supplies outside india</option>
                  <option value="Special Economic Zone">Special Economic Zone</option>
                </select>
              </div>       
            </div>

             <div class="row gstrow d-none">
              <div class="col-md-3 mt-2">
                <label id="glbl" style="color:rgb(190, 88, 88);">GSTIN/UIN *</label>
              </div>
              <div class="col-md-6 mt-2">
                <input type="text" class="form-control text-dark " id="c_gstin" name="c_gstin" placeholder="29APPCK7465F1Z1">
                <label id="gst_labell"></label>
              </div>       
            </div>

            <div class="row">
              <div class="col-md-3 mt-2">
                <label for="v_pan">PAN Number</label>
              </div>
              <div class="col-md-6 mt-2">
                <input type="text" class="form-control text-dark" id="c_pan" name="c_pan" placeholder="APPCK7465F">
                <label id="pan_labell"></label>
              </div>       
            </div> 

            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="" style="color: rgb(190, 88, 88);">Place of Supply *</label>
              </div>
              <div class="col-md-6 mt-2">
                <select class="form-control text-dark bg-light" id="placesupply" name="placesupply">
                  <option value="Nill"></option>
                  <option value="Andaman and Nicobar Islads">[AN] Andaman and Nicobar Islads</option>
                  <option value=" Andhra Predhesh">[AD] Andhra Predhesh</option>
                  <option value="Arunachal Predesh">[AR] Arunachal Predesh</option>
                  <option value="Assam">[AS] Assam</option>
                  <option value="Bihar">[BR] Bihar</option>
                  <option value=" Chandigarh">[CH] Chandigarh</option>
                  <option value="Chhattisgarh">[CG] Chhattisgarh</option>
                  <option value="Dadra and Nagar Haveli">[DNH] Dadra and Nagar Haveli</option>
                  <option value="Damn anad Diu">[DD] Damn anad Diu</option>
                  <option value=" Delhi">[DL] Delhi</option>
                  <option value="Goa">[GA] Goa</option>
                  <option value="Gujarat">[GJ] Gujarat</option>
                  <option value="Haryana">[HR] Haryana</option>
                  <option value=" Himachal Predesh">[HP] Himachal Predesh</option>
                  <option value="Jammu and Kashmir">[JK] Jammu and Kashmir</option>
                  <option value="Jharkhand">[JH] Jharkhand</option>
                  <option value=" Karnataka">[KA] Karnataka</option>
                  <option value="Kerala">[KL] Kerala</option>
                  <option value="Ladakh">[LA] Ladakh</option>
                  <option value="Lakshadweep">[LD] Lakshadweep</option>
                  <option value="Madhya Predesh">[MP] Madhya Predesh</option>
                  <option value=" Maharashtra">[MH] Maharashtra</option>
                  <option value=" Manipur">[MN] Manipur</option>
                  <option value=" Meghalaya">[ML] Meghalaya</option>
                  <option value="Mizoram">[MZ] Mizoram</option>
                  <option value="Nagaland">[NL] Nagaland</option>
                  <option value="Odisha">[OD] Odisha</option>
                  <option value="Puducherry">[PY] Puducherry</option>
                  <option value="Punjab">[PB] Punjab</option>
                  <option value="Rajasthan">[RJ] Rajasthan</option>
                  <option value="Sikkim">[SK] Sikkim</option>
                  <option value="Tamil Nadu">[TN] Tamil Nadu</option>
                  <option value="Telangana">[TS] Telangana</option>
                  <option value="Tripura">[TR] Tripura</option>
                  <option value="Uttar Predesh">[UP] Uttar Predesh</option>
                  <option value=" Uttarakhand">[UK] Uttarakhand</option>
                  <option value="West Bengal">[WB] West Bengal</option>
                  <option value=" Other Territory">[OT] Other Territory</option>
                </select>
              </div>       
            </div>

            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="c_tax" style="color: rgb(190, 88, 88);">Tax Preference* </label>
              </div>
              <div class="col-md-6 mt-2">
                <div class="d-flex">
                  <div class="radio_opt mx-5 mt-2">
                    <input type="radio" id="custtax1" name="radioCust1" value="Taxable" >
                    <label for="option1">Taxable</label>
                  </div>
                  <div class="radio_opt mx-4 mt-2">
                    <input type="radio" id="custtax2" name="radioCust1" value="Tax-exempt" >
                    <label for="option2">Tax-exempt</label>
                  </div>
                </div>
              </div>       
            </div>

            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="c_curn">Currency </label>
              </div>
              <div class="col-md-3 mt-2">
                <select class="form-control text-dark bg-light" id="c_curn" name="c_curn" required>
                  <option selected disabled value="">Choose..</option>
                  <option value="INR">INR</option>
                </select>
              </div>       
            </div>

            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="c_open">Opening Balance</label>
              </div>
              <div class="col-md-6 mt-2">
                <div class="input-group">
                  <div class="input-group-append">
                    <select class="form-gr form-select text-dark bg-light" id="bal" name="bal"
                      style="background-color: #888; width: 100px;">
                      <option value="credit">Credit</option>
                      <option value="debit">Debit</option>

                    </select>
                  </div>
                  <input type="number" class="form-control text-dark bg-light" id="c_open" name="c_open">
                </div>
              </div>       
            </div>

            <div class="row mt-2">
              <div class="col-md-3 mt-2">
                <label for="c_terms">Payment Terms</label>
              </div>
              <div class="col-md-6 mt-2">
                <div class="d-flex">
                  <select class="form-control text-dark bg-light" id="c_terms" name="c_terms" required>
                    
                    <option id="crt_term1" selected></option>
                            <option value="Net 60">Net 60</option>
                            <option value="Net 45">Net 45</option>
                            <option value="Net 30">Net 30</option>
                            <option value="Due On Receipt">Due On Receipt</option>

                            {% for p in sb %} 

                                <option value="{{ p.term }}"> {{ p.term}}</option>
                            {% endfor %}
                  </select>                
                  <a href="#" class="btn btn-outline-secondary py-2 my-1" data-target="#newpayment1" data-toggle="modal">+</a>   
                </div>
              </div>       
            </div>
            

            <hr>

            <div class="row mt-2">
              <div class="col-md-6 mt-5 text-center text-uppercase">
                <h4 class="mb-0">Billing Address</h4>
              </div>
              <div class="col-md-6 mt-5">
                <h4 class="mb-0 text-center text-uppercase">Shipping Address</h4>
              </div>
            </div>
            <div class="row mt-2 m-0 p-0 mb-2">
              <div class="col-md-9"> </div>
              <div class="col-md-3 text-right  m-0 p-0">
                <input type="checkbox" onclick="address()" id="voka" name="vokay">
                <label for="csokay" style="color: #909091;">Same As Billing Address</label>
              </div>
            </div>

            <div class="row mt-5">
              <div class="col-md-1">
                <label for="cstreet">Address</label>
              </div>
              <div class="col-md-4">
                <textarea class="form-control bg-light text-dark street" id="cstreet" name="vstreet"></textarea>
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="csstreet">Address</label>
              </div>
              <div class="col-md-4 ">
                <textarea class="form-control bg-light text-dark street" id="csstreet" name="vsstreet"></textarea>
              </div>
              <div class="col-md-1"></div>

            </div>

            <div class="row mt-2">
              <div class="col-md-1">
                <label for="ccity">City</label>
              </div>
              <div class="col-md-4">
                <input type="text" class="form-control text-dark bg-light" id="ccity" name="ccity" placeholder="City">  
              </div>
              <div class="col-md-1">
              </div>
              <div class="col-md-1">
                <label for="cscity">City</label>
              </div>
              <div class="col-md-4">
                <input type="text" class="form-control text-dark bg-light" id="cscity" name="cscity" placeholder="City">  
              </div>
              <div class="col-md-1">
              </div>
            </div>

            <div class="row mt-2">
              <div class="col-md-1">
                <label for="cstate">State</label>
              </div>
              <div class="col-md-4">
                <select type="text" class="form-control text-dark bg-light" id="cstate" name="cstate">
                  <option value="" selected>Choose</option>
                  <option value="None Of This">None Of This</option>
                  <option value="Andaman and Nicobar Islads">Andaman and Nicobar Islads</option>
                  <option value="Andhra Predhesh">Andhra Predhesh</option>
                  <option value="Arunachal Predesh">Arunachal Predesh</option>
                  <option value="Assam">Assam</option>
                  <option value="Bihar">Bihar</option>
                  <option value="Chandigarh">Chandigarh</option>
                  <option value="Chhattisgarh">Chhattisgarh</option>
                  <option value="Dadra and Nagar Haveli">Dadra and Nagar Haveli</option>
                  <option value="Damn anad Diu">Damn anad Diu</option>
                  <option value="Delhi">Delhi</option>
                  <option value="Goa">Goa</option>
                  <option value="Gujarat">Gujarat</option>
                  <option value="Haryana">Haryana</option>
                  <option value="Himachal Predesh">Himachal Predesh</option>
                  <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                  <option value="Jharkhand">Jharkhand</option>
                  <option value="Karnataka">Karnataka</option>
                  <option value="Kerala">Kerala</option>
                  <option value="Ladakh">Ladakh</option>
                  <option value="Lakshadweep">Lakshadweep</option>
                  <option value="Madhya Predesh">Madhya Predesh</option>
                  <option value="Maharashtra">Maharashtra</option>
                  <option value="Manipur">Manipur</option>
                  <option value="Meghalaya">Meghalaya</option>
                  <option value="Mizoram">Mizoram</option>
                  <option value="Nagaland">Nagaland</option>
                  <option value="Odisha">Odisha</option>
                  <option value="Puducherry">Puducherry</option>
                  <option value="Punjab">Punjab</option>
                  <option value="Rajasthan">Rajasthan</option>
                  <option value="Sikkim">Sikkim</option>
                  <option value="Tamil Nadu">Tamil Nadu</option>
                  <option value="Telangana">Telangana</option>
                  <option value="Tripura">Tripura</option>
                  <option value="Uttar Predesh">Uttar Predesh</option>
                  <option value="Uttarakhand">Uttarakhand</option>
                  <option value="West Bengal">West Bengal</option>
                  <option value="Other Territory">Other Territory</option>
                </select>
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="csstate">State</label>
              </div>
              <div class="col-md-4 ">
                <select type="text" class="form-control text-dark bg-light" id="csstate" name="csstate">
                  <option value="" selected>Choose</option>
                  <option value="None Of This">None Of This</option>
                  <option value="Andaman and Nicobar Islads">Andaman and Nicobar Islads
                  </option>
                  <option value="Andhra Predhesh">Andhra Predhesh</option>
                  <option value="Arunachal Predesh">Arunachal Predesh</option>
                  <option value="Assam">Assam</option>
                  <option value="Bihar">Bihar</option>
                  <option value="Chandigarh">Chandigarh</option>
                  <option value="Chhattisgarh">Chhattisgarh</option>
                  <option value="Dadra and Nagar Haveli">Dadra and Nagar Haveli</option>
                  <option value="Damn anad Diu">Damn anad Diu</option>
                  <option value="Delhi">Delhi</option>
                  <option value="Goa">Goa</option>
                  <option value="Gujarat">Gujarat</option>
                  <option value="Haryana">Haryana</option>
                  <option value="Himachal Predesh">Himachal Predesh</option>
                  <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                  <option value="Jharkhand">Jharkhand</option>
                  <option value="Karnataka">Karnataka</option>
                  <option value="Kerala">Kerala</option>
                  <option value="Ladakh">Ladakh</option>
                  <option value="Lakshadweep">Lakshadweep</option>
                  <option value="Madhya Predesh">Madhya Predesh</option>
                  <option value="Maharashtra">Maharashtra</option>
                  <option value="Manipur">Manipur</option>
                  <option value="Meghalaya">Meghalaya</option>
                  <option value="Mizoram">Mizoram</option>
                  <option value="Nagaland">Nagaland</option>
                  <option value="Odisha">Odisha</option>
                  <option value="Puducherry">Puducherry</option>
                  <option value="Punjab">Punjab</option>
                  <option value="Rajasthan">Rajasthan</option>
                  <option value="Sikkim">Sikkim</option>
                  <option value="Tamil Nadu">Tamil Nadu</option>
                  <option value="Telangana">Telangana</option>
                  <option value="Tripura">Tripura</option>
                  <option value="Uttar Predesh">Uttar Predesh</option>
                  <option value="Uttarakhand">Uttarakhand</option>
                  <option value="West Bengal">West Bengal</option>
                  <option value="Other Territory">Other Territory</option>
                </select>
              </div>

              <div class="col-md-1"></div>

            </div>

            <div class="row mt-2">
              <div class="col-md-1">
                <label for="ccountry">Country</label>
              </div>
              <div class="col-md-4 ">
                <input type="text" class="form-control text-dark bg-light" id="ccountry" name="ccountry" placeholder="Country">  
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="cscountry">Country</label>
              </div>
              <div class="col-md-4">
                <input type="text" class="form-control text-dark bg-light" id="cscountry"  name="cscountry" placeholder="Country">
              </div>
              <div class="col-md-1 "></div>

            </div>

            <div class="row mt-2">

              <div class="col-md-1">
                <label for="cpincode">Pincode</label>
              </div>
              <div class="col-md-4">
                <input type="text" class="form-control text-dark bg-light" id="cpincode" name="cpincode" maxlength="6" placeholder="PIN Code"> 
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="cspincode">Pincode</label>
              </div>
              <div class="col-md-4">
                <input type="text" class="form-control text-dark bg-light" id="cspincode" name="cspincode" maxlength="6" placeholder="PIN Code">  
              </div>
              <div class="col-md-1"></div>

            </div>

            <div class="row mt-2">

              <div class="col-md-1">
                <label for="cphone">Phone</label>
              </div>
              <div class="col-md-4">
                <input type="text" class="form-control text-dark bg-light" id="cphone" name="cphone" placeholder="Phone"> 
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="csphone">Phone</label>
              </div>
              <div class="col-md-4">
                <input type="text" class="form-control text-dark bg-light" id="csphone" name="csphone" placeholder="Phone">  
              </div>
              <div class="col-md-1"></div>

            </div>

            <div class="row mt-2">

              <div class="col-md-1">
                <label for="cfax">Fax</label>
              </div>
              <div class="col-md-4">
                <input type="text" class="form-control text-dark bg-light" id="cfax" name="cfax" placeholder="FAX"> 
              </div>
              <div class="col-md-1"></div>

              <div class="col-md-1">
                <label for="csfax">Fax</label>
              </div>
              <div class="col-md-4">
                <input type="text" class="form-control text-dark bg-light" id="csfax" name="csfax" placeholder="FAX">  
              </div>
              <div class="col-md-1"></div>

            </div>

            <div class="row mt-2">
                <div class="col-md-6">
                  <input type="checkbox" value="" id="invalidCheck" name="invalidCheck" required>
                  <label for="invalidCheck" style="color: #909091;">Agree to terms and conditions</label>
                  <div class="invalid-feedback text-warning" >You must agree before submitting.</div>
                </div>
            </div>
            <div class="row mt-5">
              <div class="col-md-4"></div>
              <div class="col-md-4">
                <div class="d-flex">
                  <button class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3"
                  type="submit" data-dismiss="modal" id="customersave">Submit  
                  </button> 

                  <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-4" 
                    data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">Cancel</span>
                  </button>
                </div>
              </div>
              <div class="col-md-4"></div>
            </div>
          </form>
              </div>
          </div>
      </div>
  </div>  
</div> 
<!-- items -->
<div class="modal fade" id="newitem">
  <div class="modal-dialog modal-xl">
    <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
      <div class="modal-header " style="background: rgb(32, 35, 37);">
          <h3 class="m-3 text-uppercase">New Item</h3>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
          </button>
      </div>
      <div class="modal-body" style="background: rgb(32, 35, 37);">
        <div class="card p-3 m-3">
          <form action="" method="post" class="needs-validation"  id="modalItem">
            {% csrf_token %}
            <div class="row mt-2">
              <div class="col-md-4 mr-0">
                <label class="col-form-label col-sm-2 p-0">Type <i class="fa fa-question-circle"></i></label>
              </div>
              <div class="col-md-5 ml-0 d-flex">
                <div class="radio_opt mx-5 ">
                  <input type="radio" id="item_type1" name="radioOption" value="Goods">
                  <label for="option1">Goods</label>
                </div>
                <div class="radio_opt mx-5 ">
                  <input type="radio" id="item_type2" name="radioOption" value="Services">
                  <label for="option2">Services</label>
                </div>
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-3">
                <label for="name" style="color: rgb(190, 88, 88);">Name *</label>
              </div>
              <div class="col-md-6">
                <input type="text" class="form-control text-dark bg-light" id="item_name" name="item_name" required>
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-3 ">
                <label for="units">Unit</label>
              </div>
              <div class="col-md-6">
                <div class="d-flex">
                  <select class="form-control text-dark bg-light" id="item_units" name="item_units" required>
                    <option value="">Select Unit</option>
                    {% for u in unit %}
                    <option value="{{u.id}}">{{u.unit}}</option>
                    {% endfor %}
                  </select>
                  <a href="#" class="btn btn-outline-secondary py-2 my-1" data-target="#newunit"
                    data-toggle="modal">+</a>
                </div>
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-3">
                <label for="hsn">HSN</label>
              </div>
              <div class="col-md-6">
                <input type="text" class="form-control bg-light text-dark" id="item_hsn" name="item_hsn">
              </div>
            </div>

            <div class="row mt-2">
              <div class="col-md-4 ">
                <label for="c_tax" style="color: rgb(190, 88, 88);">Tax Preference * </label>
              </div>
              <div class="col-md-5">
                <div class="d-flex">
                  <div class="radio_opt mx-5 mt-2">
                    <input type="radio" id="item-tax1" name="radioOption1" value="Taxable">
                    <label for="option1">Taxable</label>
                  </div>
                  <div class="radio_opt mx-4 mt-2">
                    <input type="radio" id="item-tax2" name="radioOption1" value="Tax-exempt">
                    <label for="option2">Tax-exempt</label>
                  </div>
                </div>
              </div>
            </div>

            <div class="row mt-2 mb-4 d-none inter-intra">
              <div class="col-md-3">
                <label for="intra">Intra-State TAX</label>
              </div>
              <div class="col-md-3">
                <select name="intra" class="form-control text-dark bg-light" id="intra">
                  <option value="">Select GST</option>

                  <option value="GST0[0%]">GST0[0%]</option>
                  <option value="GST5[5%]">GST5[5%]</option>
                  <option value="GST12[12%]">GST12[12%]</option>
                  <option value="GST18[18%]">GST18[18%]</option>
                  <option value="GST28[28%]">GST28[28%]</option>
                </select>
              </div>


              <div class="col-md-2">
                <label for="inter">Inter-State TAX</label>
              </div>
              <div class="col-md-3">
                <select name="inter" class="form-control text-dark bg-light" id="inter">
                  <option value="">Select IGST</option>

                  <option value="IGST0[0%]">IGST0[0%]</option>
                  <option value="IGST5[5%]">IGST5[5%]</option>
                  <option value="IGST12[12%]">IGST12[12%]</option>
                  <option value="IGST18[18%]">IGST18[18%]]</option>
                  <option value="IGST28[28%]">IGST28[28%]</option>
                </select>
              </div>
              <div class="col-md-1"></div>

            </div>

            <hr>

            <div class="row mt-5 text-center">
              <div class="col-md-6 d-flex text-center">
                <input type="checkbox" name="selling" checked class="mx-2 my-0">
                <h6 class="m-0">Selling Information</h6>
              </div>
              <div class="col-md-6 d-flex text-center">
                <input type="checkbox" name="purchase" checked class="mx-2 my-0">
                <h6 class="m-0">Purchase Information</h6>
              </div>
            </div>

            <div class="row mt-4">
              <div class="col-md-2">
                <label for="sell_price">Selling Price *</label>
              </div>
              <div class="col-md-4">
                <div class="input-group mb-2">
                  <div class="input-group-prepend">
                    <div class="input-group-text">INR</div>
                  </div>
                  <input required type="text" class="form-control text-dark bg-light" name="sell_price" id="sell_price">
                </div>
              </div>

              <div class="col-md-2">
                <label for="cost_price">Cost Price *</label>
              </div>
              <div class="col-md-4 ">
                <div class="input-group mb-2">
                  <div class="input-group-prepend">
                    <div class="input-group-text">INR</div>
                  </div>
                  <input required type="text" class="form-control text-dark bg-light" name="cost_price" id="cost_price">
                </div>
              </div>
            </div>

            <div class="row mt-2">
              <div class="col-md-2">
                <label for="vcity">Account</label>
              </div>
              <div class="col-md-4">
                <select name="sell_acc" id="sell_acc" class="form-control text-dark bg-light">
                  <option value="">Select Account</option>


                  {% for s in sales %}
                  <option value="{{s.id}}">{{ s.Account_name }}</option>
                  {% endfor %}
                </select>
              </div>
              <div class="col-md-2">
                <label for="cost_acc">Account</label>
              </div>
              <div class="col-md-4">
                <select name="cost_acc" class="form-control text-dark bg-light" id="cost_acc">
                  <option value="">Select Account</option>


                  {% for p in purchase %}
                  <option value="{{p.id}}">{{ p.Account_name }}</option>
                  {% endfor %}

                </select>
              </div>
            </div>

            <div class="row mt-2">
              <div class="col-md-2">
                <label for="sell_desc">Description</label>
              </div>
              <div class="col-md-4">
                <input type="text" name="sell_desc" class="form-control text-dark bg-light" id="sell_desc">
              </div>

              <div class="col-md-2">
                <label for="cost_desc">Description</label>
              </div>
              <div class="col-md-4 ">
                <input type="text" name="cost_desc" class="form-control text-dark bg-light" id="cost_desc">
              </div>

            </div>

            <div class="row" >
              <div class="col-md-10">
                {% comment %} <label><input type="checkbox" value="trackstate" name="trackstate" onclick="toggleForm()" style="display: none;">
               Track Inventory for this item</label> {% endcomment %}
                {% comment %} <input type="hidden" name="trackState" id="trackState" value="" unchecked> {% endcomment %}
                <label>
                  <input type="checkbox" name="trackstate" value="trackstate" class=" bg-dark"  onclick="toggleFormFields()">
                  Track Inventory for this item
                </label>
                <div id="formFields" style="display: none;"> 
                  <div class="form-group row" >
                    <label class="col-sm-2 col-form-label">Inventory Account *</label>
                    <div class="col-sm-10 col-md-7 col-9" style="margin-left: -1rem;">
                      <select class="form-select form-select-sm mt-3" name="invacc" id="invacc">
                        <option>Choose..</option>
                        <option value="inventory assets">Inventory Asset</option>
                      </select>
                    </div>
                  </div>
                  <div class="form-group row ">
                    <label class="col-sm-2 col-form-label">Opening Stock</label>
                    <div class=" col-md-5">
                      <input  type="number" class="form-control  bg-dark" id="openstock"  name="openstock" value="0">
                    </div>
                    <div class="col-md-5  ">
                      <div class="row align-items-center">
                        <label class="col-sm-6 col-form-label">Opening Stock Rate per Unit</label>
                        <div class="col-sm-6">
                          <input type="number" class="form-control bg-dark" name="inventoryaccntperunit" id="inventoryaccntperunit"  value="0">
                        </div>

                      </div>
                    </div>
                    <fieldset class="form-group">
                      <div class="row">
                        <label class="col-form-label col-sm-2 pt-2">Activation tag<i class="fa fa-question-circle"></i></label>
                        <div class="col-sm-10 form-inline">
                          <div class="form-check ">
                            <input  class="form-check-input" type="radio" name="satus" id="gridRadios1" value="Active"  style="margin-left:5px;" >
                            <label class="form-check-label" for="gridRadios1">Activate</label>
                          </div>
                          <div class="form-check ml-5">
                            <input  class="form-check-input" type="radio" name="satus" id="gridRadios2" value="Inactive"  style="margin-left:50px;">
                            <label class="form-check-label" for="gridRadios2">Non-Activate</label>
                          </div>
                                      
                        </div>
                      </div>
                    </fieldset>

                  </div>
                </div>
              </div>
            </div>
           

            <div class="row ">
              <div class="col-md-5"></div>
              <div class="col-md-3">
                <div class="d-flex">
                  <button class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3" type="submit" data-dismiss="modal"
                    id="itemSave">Submit
                  </button>

                  <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-4" data-dismiss="modal"
                    aria-label="Close">
                    <span aria-hidden="true">Cancel</span>
                  </button>
                </div>
              </div>
              <div class="col-md-4"></div>
            </div>
            
          </form>
              </div>
          </div>
      </div>
  </div>  
</div> 
<!-- payment -->
<div class="modal fade" id="newpayment">
  <div class="modal-dialog modal-xl">
    <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
      <div class="modal-header " style="background: rgb(32, 35, 37);">
          <h3 class="m-3 text-uppercase">New Payment Terms</h3>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
          </button>
      </div>
      <div class="modal-body" style="background: rgb(32, 35, 37);">
        <div class="card p-3 m-3">
          <form action="" method="post" class="needs-validation"  id="modalPayment">
            {% csrf_token %}
    
            <div class="row mt-2">
              <div class="col-md-2 mt-2"></div>
              <div class="col-md-4 mt-2">
                <center><label for="termname" style="color: rgb(190, 88, 88);">Term Name *</label></center>
              </div>

              <div class="col-md-4 mt-2">
                <center><label for="termdays" style="color: rgb(190, 88, 88);">Number of Days *</label></center>
              </div>
              <div class="col-md-2 mt-2"></div>
            </div>

            <div class="row mt-2">
              <div class="col-md-2 mt-2"></div>

              <div class="col-md-4 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="tname" name="term_name" required>      
              </div>

              <div class="col-md-4 mt-2">
                <input type="number" class="form-control text-dark bg-light" id="tdays" name="term_days" required>
              </div>
              <div class="col-md-2 mt-2"></div>

            </div>

            <div class="row mt-5">
              <div class="col-md-4"></div>
              <div class="col-md-4">
                <div class="d-flex">
                  <button class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3"
                  type="submit" data-dismiss="modal" id="paySave">Save
                  </button> 
                  

                  <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-4" 
                    data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">Cancel</span>
                  </button>
                </div>
              </div>
              <div class="col-md-4"></div>
            </div>
          </form>
              </div>
          </div>
      </div>
  </div>  
</div> 
<!-- every terms -->
<div class="modal fade" id="repeatevery">
  <div class="modal-dialog modal-xl">
    <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
      <div class="modal-header " style="background: rgb(32, 35, 37);">
          <h3 class="m-3 text-uppercase">Add RepeatEvery </h3>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
          </button>
      </div>
      <div class="modal-body" style="background: rgb(32, 35, 37);">
        <div class="card p-3 m-3">
          <form action="" method="post" class="needs-validation"  id="modalrepeat">
            {% csrf_token %}
    
            <div class="row mt-2">
              <div class="col-md-2 mt-2"></div>
              <div class="col-md-4 mt-2">
                <center><label for="every" style="color: rgb(190, 88, 88);">Term Name *</label></center>
              </div>
            </div>
            
            <div class="row mt-2">
              <div class="col-md-2 mt-2"></div>

              <div class="col-md-4 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="ename" name="term_name" required>      
              </div>

            

            </div>
            <div class="row mt-5">
              <div class="col-md-4"></div>
              <div class="col-md-4">
                <div class="d-flex">
                  <button class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3"
                  type="submit" data-dismiss="modal" id="everySave">Save
                  </button> 
                  

                  <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-4" 
                    data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">Cancel</span>
                  </button>
                </div>
              </div>
              <div class="col-md-4"></div>
            </div>


            

          </form>
              </div>
          </div>
      </div>
  </div>  
</div> 

<!-- ...............................unit........................................................ -->

<div class="modal fade" id="newunit">
  <div class="modal-dialog modal-xl">
    <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
      <div class="modal-header " style="background: rgb(32, 35, 37);">
          <h3 class="m-3 text-uppercase">New Customer</h3>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
          </button>
      </div>
      <div class="modal-body" style="background: rgb(32, 35, 37);">
        <div class="card p-3 m-3">
          <form action="" method="post" class="needs-validation"  id="modalUnit">
            {% csrf_token %}
    
            <div class="row mt-2">
              <div class="col-md-3 mt-2"></div>
              <div class="col-md-1 mt-2">
                <label for="unit" style="color: rgb(190, 88, 88);">Unit</label>
              </div>

              <div class="col-md-4 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="unit" name="unit" required>
              </div>
              <div class="col-md-4 mt-2"></div>
            </div>

            <div class="row mt-5">
              <div class="col-md-4"></div>
              <div class="col-md-4">
                <div class="d-flex">
                  <button class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3" type="submit" data-dismiss="modal"
                    id="unitSave">Save
                  </button>


                  <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-4" data-dismiss="modal"
                    aria-label="Close">
                    <span aria-hidden="true">Cancel</span>
                  </button>
                </div>
              </div>
              <div class="col-md-4"></div>
            </div>
          </form>
              </div>
          </div>
      </div>
  </div>  
</div>

<!-- ...................................end.......................................................... -->

<!-- ............................... Customer Payment............................................. -->

<div class="modal fade" id="newpayment1">
  <div class="modal-dialog modal-xl">
    <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
      <div class="modal-header " style="background: rgb(32, 35, 37);">
          <h3 class="m-3 text-uppercase">New Payment Terms</h3>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
          </button>
      </div>
      <div class="modal-body" style="background: rgb(32, 35, 37);">
        <div class="card p-3 m-3">
          <form action="" method="post" class="needs-validation"  id="modalPayment1">
            {% csrf_token %}
    
            <div class="row mt-2">
              <div class="col-md-2 mt-2"></div>
              <div class="col-md-4 mt-2">
                <center><label for="termname" style="color: rgb(190, 88, 88);">Term Name *</label></center>
              </div>

              <div class="col-md-4 mt-2">
                <center><label for="termdays" style="color: rgb(190, 88, 88);">Number of Days *</label></center>
              </div>
              <div class="col-md-2 mt-2"></div>
            </div>

            <div class="row mt-2">
              <div class="col-md-2 mt-2"></div>

              <div class="col-md-4 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="tname1" name="term_name" required>      
              </div>

              <div class="col-md-4 mt-2">
                <input type="number" class="form-control text-dark bg-light" id="tdays1" name="term_days" required>
              </div>
              <div class="col-md-2 mt-2"></div>

            </div>

            <div class="row mt-5">
              <div class="col-md-4"></div>
              <div class="col-md-4">
                <div class="d-flex">
                  <button class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3"
                  type="submit" data-dismiss="modal" id="paySave1">Save
                  </button> 
                  

                  <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-4" 
                    data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">Cancel</span>
                  </button>
                </div>
              </div>
              <div class="col-md-4"></div>
            </div>
          </form>
              </div>
          </div>
      </div>
  </div>  
</div> 

<!-- ................................................................................................... -->
<script>
  $(document).on("click","#paySave1",function(){
  console.log($("#tname1").val())
  console.log($("#tdays1").val())

$.ajax({
  type : 'POST',
  url:"{% url 'payment_terms_cust' %}",

  data:{
      name : $("#tname1").val(),
      days : $("#tdays1").val(),
      
      csrfmiddlewaretoken: '{{ csrf_token }}'
      
    },
  
    success: function(response) {
      console.log('welcome')
      term_name=response.terms
      document.getElementById("crt_term1").innerHTML=term_name
      document.getElementById("modalPayment1").reset();
      // reloadPayment();
    },
});        
});


        </script>


<script>
  $(document).ready(function () {
    $("#cfname, #clname").change(function () {
      $("#cdisplayname").text($("#ctitle").val() + " " + $("#cfname").val() + " " + $("#clname").val());
    });
  });


  $(document).ready(function () {
    $("#c_gsttype").change(function () {
      var x = $('#c_gsttype').val();
      console.log(x)
      if (x == "Unregistered Business-not Registered under GST") {
        $(".gstrow").addClass('d-none');


      }
      else if (x == 'Overseas- Persons with who you do import or exports of supplies outside india') {
        $(".gstrow").addClass('d-none');
        console.log('poor')
      }
      else {
        $(".gstrow").removeClass('d-none');
        $(".gstrow").addClass('d-flex');

      }

    });
  });


  $(document).ready(function () {
    $("#c_gstin").change(function () {

      var x = $("#c_gstin").val();
      var gst_label = document.getElementById("gst_label")
      var expr = /^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/;
      if (!expr.test(x)) {
        gst_label.style.color = "red";
        gst_label.innerHTML = "Invalid GST Number.";
      }
      else {
        gst_label.style.color = "green";
        gst_label.innerHTML = "valid GST Number.";

      }
    });
  });

  $(document).ready(function () {
    $("#c_pan").change(function () {
      var x = $("#c_pan").val();
      var pan_label = document.getElementById("pan_label")
      var expr = /^[A-Z]{5}[0-9]{4}[A-Z]{1}$/
      if (!expr.test(x)) {
        pan_label.style.color = "red";
        pan_label.innerHTML = "Invalid PAN Number.";
      }
      else {
        pan_label.style.color = "green";
        pan_label.innerHTML = "valid PAN Number.";

      }
    });
  });






  function address() {
    var chkbtn = document.getElementById('voka');
    if (chkbtn.checked == true) {
      document.getElementById('csstreet').value = document.getElementById('cstreet').value;
      document.getElementById('cscity').value = document.getElementById('ccity').value;
      document.getElementById('cspincode').value = document.getElementById('cpincode').value;
      document.getElementById('cscountry').value = document.getElementById('ccountry').value;
      document.getElementById('csstate').value = document.getElementById('cstate').value;
      document.getElementById('csphone').value = document.getElementById('cphone').value;
      document.getElementById('csfax').value = document.getElementById('cfax').value;
    }
    else {
      document.getElementById('csstreet').value = '';
      document.getElementById('cscity').value = '';
      document.getElementById('csstate').value = '';
      document.getElementById('cspincode').value = '';
      document.getElementById('cscountry').value = '';
      document.getElementById('csphone').value = '';
      document.getElementById('csfax').value = '';
    }
  }

</script>

<script>
  function toggleFormFields() {
    var formFields = document.getElementById("formFields");
    var checkbox = document.querySelector("input[name=trackstate]");

    if (checkbox.checked) {
      formFields.style.display = "block";
    } else {
      formFields.style.display = "none";
    }
  }
</script>



<script>
  function saveAsDraftDialog() {

    var frm = document.getElementById("forms");
    frm.action = ("{% url 'new_recur1' %}")
  }

  function saveAndOpenDialog() {

    var frm = document.getElementById("forms");
    frm.action = ("{% url 'new_recur' %}")
  }
  $(document).ready(function () {
    $('[data-toggle="tooltip"]').tooltip();
  });

</script>


<script>
  document.addEventListener("DOMContentLoaded", function () {
    var today = new Date().toISOString().substr(0, 10);
    document.getElementById("startd").value = today;

    var billDateInput = document.getElementById("startd");
    var dueDateInput = document.getElementById("endd");
    var paymentTermsSelect = document.getElementById("terms");

    paymentTermsSelect.addEventListener("change", function () {
      console.log("Change event triggered."); // Debugging line
      var selectedOption = paymentTermsSelect.options[paymentTermsSelect.selectedIndex];
      var paymentTermsValue = parseInt(selectedOption.value); // Convert to integer
      console.log(selectedOption)

      console.log("Payment terms value: " + paymentTermsValue); // Debugging line

      var billDate = new Date(billDateInput.value);
      console.log("Bill date: " + billDate); // Debugging line

      // Calculate the due date
      var dueDate = new Date(billDate);
      if (selectedOption.value === "0") {
        // Due on Receipt, so due date is the same as the bill date
        dueDate.setDate(billDate.getDate());
      } else {
        // Add the payment terms (in days) to the bill date
        dueDate.setDate(billDate.getDate() + paymentTermsValue - 1);
      }

      console.log("Due date: " + dueDate); // Debugging line

      // Format dueDate as "YYYY-MM-DD" and set it as the value of the due date input
      dueDateInput.value = dueDate.toISOString().split("T")[0];
    });
  });
</script>


<script>
  function handleTaxChange(selectId) {
    var pos = $("#pos").val();
    var sos = $("#state").val();

    if (pos === sos) {
      $(`#tax${selectId} optgroup[label="GST"]`).show();
      $(`#tax${selectId} optgroup[label="IGST"]`).hide();
    } else {
      $(`#tax${selectId} optgroup[label="GST"]`).hide();
      $(`#tax${selectId} optgroup[label="IGST"]`).show();
    }
  }

</script>



<script>


  $(document).on("click", "#paySave", function () {
    console.log($("#tname").val())
    console.log($("#tdays").val())

    $.ajax({
      type: 'POST',
      url: "{% url 'payment_recur' %}",

      data: {
        name: $("#tname").val(),
        days: $("#tdays").val(),

        csrfmiddlewaretoken: '{{ csrf_token }}'

      },

      success: function (response) {
        term_name = response.terms
        document.getElementById("crt_term").innerHTML = term_name
        document.getElementById("modalPayment").reset();
        // reloadPayment();
      },
    });
  });



  $(document).on("click", "#everySave", function () {
    // console.log($("#tname").val())
    // console.log($("#tdays").val())

    $.ajax({
      type: 'POST',
      url: "{% url 'every_terms' %}",

      data: {
        name: $("#ename").val(),
        // days : $("#tdays").val(),

        csrfmiddlewaretoken: '{{ csrf_token }}'

      },

      success: function (response) {
        terms_name = response.terms
        document.getElementById("ev_term").innerHTML = terms_name
        document.getElementById("modalrepeat").reset();
        // reloadPayment();
      },
    });
  });


  // customer

  $(document).on("click", "#customersave", function () {
    if ($('input[name="radioCust"]:checked').val() == 'Business') {

      itemtype = $('#business').val();
    }
    else {
      itemtype = $('#individual').val();
    }

    if ($('input[name="radioOption2"]:checked').val() == 'Taxable') {
      inte = $('#item-tax3').val();

    }
    else {
      inte = $('#item-tax4').val();
    }


    $.ajax({

      type: 'POST',
      url: "{% url 'recurinvoice_customer' %}",

      data: {
        tax: inte,
        itemtype: itemtype,
        title: $("#ctitle").val(),
        customer_type:$("#radioCust").val(),
        firstname: $("#cfname").val(),
        lastname: $("#clname").val(),
        company_name: $("#ccompany").val(),
        display_name: $('#cdisplayname').text(),
        email: $("#cemail").val(),
        website: $("#cwsite").val(),
        work_mobile: $("#cw_mobile").val(),
        pers_mobile: $("#cp_mobile").val(),
        skype: $("#cskype").val(),
        facebook: $("#facebook").val(),
        twitter: $("#twitter").val(),
        desg: $("#c_desg").val(),
        dpt: $("#c_dpt").val(),
        gsttype: $("#c_gsttype").val(),
        gstin: $("#c_gstin").val(),
        panno: $("#c_pan").val(),
        placesupply: $("#placesupply").val(),
        currency: $("#c_curn").val(),
        openingbalance: $("#c_open").val(),
        crdb: $("#bal").val(),
        paymentterms: $("#c_terms").val(),
        street: $("#cstreet").val(),
        city: $("#ccity").val(),
        state: $("#cstate").val(),
        pincode: $("#cpincode").val(),
        fax: $("#cfax").val(),
        phone: $("#cphone").val(),
        country: $("#ccountry").val(),
        shipstreet: $("csstreet").val(),
        shipcity: $("#cscity").val(),
        shipstate: $("#csstate").val(),
        shippincode: $("#cspincode").val(),
        shipcountry: $("#cscountry").val(),
        shipfax: $("#csfax").val(),
        shipphone: $("#csphone").val(),
        radioCust: $("input[name='radioCust']:checked").val(),
        csrfmiddlewaretoken: '{{ csrf_token }}',
      },

      success: function (response) {
        document.getElementById("modalCustomer").reset();


        // reloadcustomer();
        $.ajax({
          url: "{% url 'customer_dropdown' %}",
          type: "GET",
          dataType: "json",
          data: $(this).serialize(),
          csrfmiddlewaretoken: '{{ csrf_token }}',

          success: function (data) {
            var dropdown = $('#customer_sel');
            console.log(data)
            dropdown.empty();
            $.each(data, function (key, value) {
              // dropdown.append($('<option></option>').attr('value', key).text(value[1]).val(value[0] + ' ' + value[1]));
              console.log(key)
              console.log(value[1])
              dropdown.append($('<option></option>').attr('value', value[1]).text(value[1]));
            });
          },
          error: function (xhr, status, error) {
            console.error(xhr.responseText);
          }
        });
      },
    });
  });

 
  


  // item creation.......................................................................


  $(document).ready(function () {

    $("#item-tax1").click(function () {
      $(".inter-intra").removeClass('d-none');
      $(".inter-intra").addClass('d-flex');
    });

    $("#item-tax2").click(function () {

      $(".inter-intra").removeClass('d-flex');
      $(".inter-intra").addClass("d-none");
    });
  });


  $(document).on("click", "#itemSave", function () {

    if ($('input[name="radioOption"]:checked').val() == 'Goods') {

      itemtype = $('#item_type1').val();
    }
    else {
      itemtype = $('#item_type2').val();
    }

    if ($('input[name="radioOption1"]:checked').val() == 'Taxable') {
      inter_st = $('#inter').val();
      intra_st = $('#intra').val();
    }
    else {
      inter_st = 0;
      intra_st = 0;
    }

    $.ajax({

      type: 'POST',
      url: "{% url 'recurbills_item' %}",

      data: {
        type: itemtype,
        name: $("#item_name").val(),
        unit: $("#item_units").val(),
        hsn: $("#item_hsn").val(),
        inter: inter_st,
        intra: intra_st,
        sell_price: $("#sell_price").val(),
        cost_price: $("#cost_price").val(),
        sell_acc: $("#sell_acc").val(),
        cost_acc: $("#cost_acc").val(),
        sell_desc: $("#sell_desc").val(),
        cost_desc: $("#cost_desc").val(),
        openstock:$("#openstock").val(),
        openunit: $("#inventoryaccntperunit").val(),

        csrfmiddlewaretoken: '{{ csrf_token }}'

      },

      success: function (response) {
        // console.log(response)
        document.getElementById("modalItem").reset();
        reloadItem();
      },
    });
  });



  function reloadItem() {
    $.ajax({
      url: "{% url 'item_dropdown' %}",
      type: "GET",
      dataType: "json",
      data: $(this).serialize(),
      csrfmiddlewaretoken: '{{ csrf_token }}',

      success: function (data) {
        var dropdown = $('.itm');
        var dropdown1 = $('.itmm');
        dropdown.empty();
        dropdown1.empty();
        $.each(data, function (key, value) {
          dropdown.append($('<option class="text-dark"></option>').attr('value', key).text(value[0]).val(value[1]));
          dropdown1.append($('<option class="text-dark"></option>').attr('value', key).text(value[0]).val(value[1]));
        });

      },
      error: function (xhr, status, error) {
        console.error(xhr.responseText);
      }
    });
  }

  // unit modal


  $(document).on("click", "#unitSave", function () {
    $.ajax({
      type: 'POST',
      url: "{% url 'recurbills_unit' %}",
      data: {
        unit: $("#unit").val(),
        csrfmiddlewaretoken: '{{ csrf_token }}'
      },
      success: function (response) {
        document.getElementById("modalUnit").reset();
        reloadUnit();
      },
    });
  });


  function reloadUnit() {

    $.ajax({
      url: "{% url 'unit_dropdown' %}",
      type: "GET",
      dataType: "json",
      data: $(this).serialize(),
      csrfmiddlewaretoken: '{{ csrf_token }}',

      success: function (data) {
        var dropdown = $('#item_units');
        dropdown.empty();

        $.each(data, function (key, value) {
          dropdown.append($('<option></option>').attr('value', key).text(value[0]).val(value[1]));
        });
      },
      error: function (xhr, status, error) {
        console.error(xhr.responseText);
      }
    });
  }







</script>
<!-- end -->




<script>




  // Add new row
  $(document).ready(function () {
    $('#add-row').click(function () {
      // var pos =document.getElementById("pos").value;
      // var state = document.getElementById("state").value;

      var table = document.getElementById("item_table");
      var RowCount = table.rows.length;
      console.log(RowCount);
      var newRow = $(`
          <tr id='row${RowCount}' >
              <td>
                  <div class='form-group'>
                      <select
                          class='form-control bg-transparent  text-black border-0 item_select' name='item[]'
                          id='item1${RowCount}'>
                          <option class='text-dark'>Select Items</option>
                          {% for i in item %}
                          <option class="text-dark" value="{{i.Name}}">{{i.Name}}</option>
                          {% endfor %}
                      </select></div>
              </td>
              <td class='text-right'><input type='number' id='hsn${RowCount}'
                                class='bg-transparent border-0 text-black text-right hsn' name='hsn[]'
                                value='0.00'style="width: 75%;">
                        </td>
              <td class='text-right'><input type='number' id='qty${RowCount}'
                      class= 'form-control bg-transparent border-0 text-black text-right qty' name='quantity[]' value='0.00'style="width: 75%;" >
              </td>
              
              <td class='text-right'><input type='number' id='rate${RowCount}'
                      class='form-control bg-transparent border-0 text-black text-right rate' name='rate[]' value='0.00'style="width: 75%;"
                      ></td>
             
              <td class='text-right'><input type='number' id='discount${RowCount}'
                      class='form-control bg-transparent border-0 text-black text-right discount' name='discount[]' value='0.00' style="width: 75%;">
              </td>
              <td class='text-right'>
                <input type="hidden" name='taxamount' id="taxamount1${RowCount}"  class=" taxamount" style="color: black;" />

                 <select name='tax[]' id='tax${RowCount}'
                        class="form-control bg-transparent text-black text-right border-0 tax"
                        >
                        <optgroup label="GST" >
                                <option value=0>Non Taxable</option>
                                <option value=0>0% GST</option>
                                <option value=5>5% GST</option>
                                <option value=12>12% GST</option>
                                <option value=18>18% GST</option>
                                <option value=28>28% GST</option>
                            </optgroup>
                            <optgroup label="IGST" >
                                <option value=0>0% IGST</option>
                                <option value=5>5% IGST</option>
                                <option value=12>12% IGST</option>
                                <option value=18>18% IGST</option>
                                <option value=28>28% IGST</option>
                            </optgroup>
                       
                    </select></td>
                    
              <td class='text-right'><input type='number' id='amount${RowCount}'
                      class='form-control bg-transparent  border-0 text-black text-right amount' name='amount[]' value='0.00'style="width: 85%;"></td>
              <td class='text-center'><button type='button' id='del_btn${RowCount}'
                      class='btn btn- text-danger btn-sm btn-outline-danger rounded-circle delete-row'
                      style='width:30px'><i class='fa fa-times'></i></button></td>
          </tr>`);
      $('#item_table').append(newRow);
    });

    $('#item_table').on('click', '.delete-row', function () {
      $(this).closest('tr').remove();
      calc();
    });

  });





</script>


<script>

  $(document).ready(function () {


    var roinc = 0
    console.log("ajax");
    // var place = document.getElementById('pos').value;

    $(document).on('click', '#item1', function () {
      select = $('#item1').val();
      customer = $('#customer_sel').val();
      //   console.log(select);
      //   console.log(customer);
      $.ajax({
        type: "GET",
        url: "{% url 'itemdata_recur' %}",
        data: {
          id: select,
          cust: customer
        },
        success: function (response) {
          console.log(response)
          data = response.rate
          data1 = response.gst
          data2 = response.igst
          data3 = response.pos
          data4 = response.hsncode
          document.getElementById('rate1').value = data
          document.getElementById('hsn1').value = data4

          var pos = document.getElementById("pos").value;
          var sos = document.getElementById("state").value;

          $(document).ready(function () {
            if (pos === sos) {
              $('#tax1 optgroup[label="GST"]').show();
              $('#tax1 optgroup[label="IGST"]').hide();
            } else {
              $('#tax1 optgroup[label="GST"]').hide();
              $('#tax1 optgroup[label="IGST"]').show();
            }
          });
          //               var pos = document.getElementById("pos").value;
          //                 var sos = document.getElementById("sos").value;

          //                 $(document).ready(function() {
          //                     if(pos==state){
          //         document.getElementById('tax1').style.display="block";
          //         document.getElementById('tax2').style.display="none";
          //         document.getElementById('taxcheck').style.display="none";
          //     }
          //     else{
          //         document.getElementById('tax2').style.display="block";
          //         document.getElementById('tax1').style.display="none";
          //         document.getElementById('taxcheck').style.display="none"; 
          //     }

          // });

          //   if (data3 == '{{ company.state }}') {
          //       document.getElementById('tgst1').innerHTML = data1 + ' % GST';
          //       document.getElementById('tgst1').value = data1
          //   }
          //   document.getElementById('tigst1').innerHTML = data2 + ' % IGST';
          //   document.getElementById('tigst1').value = data2

        }
      });

    });
    // console.log('pos:'+place_of_supply);
    $(document).on('click', '#item12', function () {
      select = $('#item12').val();
      customer = $('#customer_sel').val();
      console.log(select);
      console.log(customer);
      $.ajax({
        type: "GET",
        url: "{% url 'itemdata_recur' %}",
        data: {
          id: select,
          cust: customer
        },
        success: function (response) {
          console.log(response)
          data = response.rate
          data1 = response.gst
          data2 = response.igst
          data3 = response.pos
          data4 = response.hsncode

          document.getElementById('rate2').value = data
          document.getElementById('hsn2').value = data4

          var pos = document.getElementById("pos").value;
          var sos = document.getElementById("state").value;

          $(document).ready(function () {
            if (pos === sos) {
              $('#tax2 optgroup[label="GST"]').show();
              $('#tax2 optgroup[label="IGST"]').hide();
            } else {
              $('#tax2 optgroup[label="GST"]').hide();
              $('#tax2 optgroup[label="IGST"]').show();
            }
          });



        }
      });

    });

    $(document).on('click', '#item13', function () {
      select = $('#item13').val();
      customer = $('#customer_sel').val();
      console.log(select);
      console.log(customer);
      $.ajax({
        type: "GET",
        url: "{% url 'itemdata_recur' %}",
        data: {
          id: select,
          cust: customer
        },
        success: function (response) {
          console.log(response)
          data = response.rate
          data1 = response.gst
          data2 = response.igst
          data3 = response.pos
          data4 = response.hsncode

          document.getElementById('rate3').value = data
          document.getElementById('hsn3').value = data4

          var pos = document.getElementById("pos").value;
          var sos = document.getElementById("state").value;

          $(document).ready(function () {
            if (pos === sos) {
              $('#tax3 optgroup[label="GST"]').show();
              $('#tax3 optgroup[label="IGST"]').hide();
            } else {
              $('#tax3 optgroup[label="GST"]').hide();
              $('#tax3 optgroup[label="IGST"]').show();
            }
          });
        }
      });

    });

    $(document).on('click', '#item14', function () {
      select = $('#item14').val();
      customer = $('#customer_sel').val();
      console.log(select);
      console.log(customer);
      $.ajax({
        type: "GET",
        url: "{% url 'itemdata_recur' %}",
        data: {
          id: select,
          cust: customer
        },
        success: function (response) {
          console.log(response)
          data = response.rate
          data1 = response.gst
          data2 = response.igst
          data3 = response.pos
          data4 = response.hsncode

          document.getElementById('rate4').value = data
          document.getElementById('hsncode4').value = data4


          if (data3 == '{{ company.state }}') {
            document.getElementById('tgst4').innerHTML = data1 + ' % GST';
            document.getElementById('tgst4').value = data1
          }
          document.getElementById('tigst4').innerHTML = data2 + ' % IGST';
          document.getElementById('tigst4').value = data2

        }
      });

    });

    $(document).on('click', '#item15', function () {
      select = $('#item15').val();
      customer = $('#customer_sel').val();
      console.log(select);
      console.log(customer);
      $.ajax({
        type: "GET",
        url: "{% url 'itemdata_recur' %}",
        data: {
          id: select,
          cust: customer
        },
        success: function (response) {
          console.log(response)
          data = response.rate
          data1 = response.gst
          data2 = response.igst
          data3 = response.pos
          document.getElementById('rate5').value = data

          if (data3 == '{{ company.state }}') {
            document.getElementById('tgst5').innerHTML = data1 + ' % GST';
            document.getElementById('tgst5').value = data1
          }
          document.getElementById('tigst5').innerHTML = data2 + ' % IGST';
          document.getElementById('tigst5').value = data2

        }
      });

    });

    $(document).on('click', '#item16', function () {
      select = $('#item16').val();
      customer = $('#customer_sel').val();
      console.log(select);
      console.log(customer);
      $.ajax({
        type: "GET",
        url: "{% url 'itemdata_recur' %}",
        data: {
          id: select,
          cust: customer
        },
        success: function (response) {
          console.log(response)
          data = response.rate
          data1 = response.gst
          data2 = response.igst
          data3 = response.pos
          document.getElementById('rate6').value = data

          if (data3 == '{{ company.state }}') {
            document.getElementById('tgst6').innerHTML = data1 + ' % GST';
            document.getElementById('tgst6').value = data1
          }
          document.getElementById('tigst6').innerHTML = data2 + ' % IGST';
          document.getElementById('tigst6').value = data2

        }
      });

    });

    $(document).on('click', '#item17', function () {
      select = $('#item17').val();
      customer = $('#customer_sel').val();
      console.log(select);
      console.log(customer);
      $.ajax({
        type: "GET",
        url: "{% url 'itemdata_recur' %}",
        data: {
          id: select,
          cust: customer
        },
        success: function (response) {
          console.log(response)
          data = response.rate
          data1 = response.gst
          data2 = response.igst
          data3 = response.pos
          document.getElementById('rate7').value = data

          if (data3 == '{{ company.state }}') {
            document.getElementById('tgst7').innerHTML = data1 + ' % GST';
            document.getElementById('tgst7').value = data1
          }
          document.getElementById('tigst7').innerHTML = data2 + ' % IGST';
          document.getElementById('tigst7').value = data2

        }
      });

    });

    $(document).on('click', '#item18', function () {
      select = $('#item18').val();
      customer = $('#customer_sel').val();
      console.log(select);
      console.log(customer);
      $.ajax({
        type: "GET",
        url: "{% url 'itemdata_recur' %}",
        data: {
          id: select,
          cust: customer
        },
        success: function (response) {
          console.log(response)
          data = response.rate
          data1 = response.gst
          data2 = response.igst
          data3 = response.pos
          document.getElementById('rate8').value = data

          if (data3 == '{{ company.state }}') {
            document.getElementById('tgst8').innerHTML = data1 + ' % GST';
            document.getElementById('tgst8').value = data1
          }
          document.getElementById('tigst8').innerHTML = data2 + ' % IGST';
          document.getElementById('tigst8').value = data2

        }
      });

    });

    $(document).on('click', '#item19', function () {
      select = $('#item19').val();
      customer = $('#customer_sel').val();
      console.log(select);
      console.log(customer);
      $.ajax({
        type: "GET",
        url: "{% url 'itemdata_recur' %}",
        data: {
          id: select,
          cust: customer
        },
        success: function (response) {
          console.log(response)
          data = response.rate
          data1 = response.gst
          data2 = response.igst
          data3 = response.pos
          document.getElementById('rate9').value = data

          if (data3 == '{{ company.state }}') {
            document.getElementById('tgst9').innerHTML = data1 + ' % GST';
            document.getElementById('tgst9').value = data1
          }
          document.getElementById('tigst9').innerHTML = data2 + ' % IGST';
          document.getElementById('tigst9').value = data2

        }
      });

    });

    $(document).on('click', '#item10', function () {
      select = $('#item10').val();
      customer = $('#customer_sel').val();
      console.log(select);
      console.log(customer);
      $.ajax({
        type: "GET",
        url: "{% url 'itemdata_recur' %}",
        data: {
          id: select,
          cust: customer
        },
        success: function (response) {
          console.log(response)
          data = response.rate
          data1 = response.gst
          data2 = response.igst
          data3 = response.pos
          document.getElementById('rate10').value = data

          if (data3 == '{{ company.state }}') {
            document.getElementById('tgst10').innerHTML = data1 + ' % GST';
            document.getElementById('tgst10').value = data1
          }
          document.getElementById('tigst10').innerHTML = data2 + ' % IGST';
          document.getElementById('tigst10').value = data2

        }
      });

    });

    $(document).on('click', '#item11', function () {
      select = $('#item11').val();
      customer = $('#customer_sel').val();
      console.log(select);
      console.log(customer);
      $.ajax({
        type: "GET",
        url: "{% url 'itemdata_est' %}",
        data: {
          id: select,
          cust: customer
        },
        success: function (response) {
          console.log(response)
          data = response.rate
          data1 = response.gst
          data2 = response.igst
          data3 = response.pos
          document.getElementById('rate11').value = data

          if (data3 == '{{ company.state }}') {
            document.getElementById('tgst11').innerHTML = data1 + ' % GST';
            document.getElementById('tgst11').value = data1
          }
          document.getElementById('tigst11').innerHTML = data2 + ' % IGST';
          document.getElementById('tigst11').value = data2

        }
      });

    });

    $(document).on('click', '#item12', function () {
      select = $('#item12').val();
      customer = $('#customer_sel').val();
      console.log(select);
      console.log(customer);
      $.ajax({
        type: "GET",
        url: "{% url 'itemdata_est' %}",
        data: {
          id: select,
          cust: customer
        },
        success: function (response) {
          console.log(response)
          data = response.rate
          data1 = response.gst
          data2 = response.igst
          data3 = response.pos
          document.getElementById('rate12').value = data

          if (data3 == '{{ company.state }}') {
            document.getElementById('tgst12').innerHTML = data1 + ' % GST';
            document.getElementById('tgst12').value = data1
          }
          document.getElementById('tigst12').innerHTML = data2 + ' % IGST';
          document.getElementById('tigst12').value = data2

        }
      });

    });

    $(document).on('click', '#item13', function () {
      select = $('#item13').val();
      customer = $('#customer_sel').val();
      console.log(select);
      console.log(customer);
      $.ajax({
        type: "GET",
        url: "{% url 'itemdata_est' %}",
        data: {
          id: select,
          cust: customer
        },
        success: function (response) {
          console.log(response)
          data = response.rate
          data1 = response.gst
          data2 = response.igst
          data3 = response.pos
          document.getElementById('rate13').value = data

          if (data3 == '{{ company.state }}') {
            document.getElementById('tgst13').innerHTML = data1 + ' % GST';
            document.getElementById('tgst13').value = data1
          }
          document.getElementById('tigst13').innerHTML = data2 + ' % IGST';
          document.getElementById('tigst13').value = data2

        }
      });

    });

    $(document).on('click', '#item14', function () {
      select = $('#item14').val();
      customer = $('#customer_sel').val();
      console.log(select);
      console.log(customer);
      $.ajax({
        type: "GET",
        url: "{% url 'itemdata_est' %}",
        data: {
          id: select,
          cust: customer
        },
        success: function (response) {
          console.log(response)
          data = response.rate
          data1 = response.gst
          data2 = response.igst
          data3 = response.pos
          document.getElementById('rate14').value = data

          if (data3 == '{{ company.state }}') {
            document.getElementById('tgst14').innerHTML = data1 + ' % GST';
            document.getElementById('tgst14').value = data1
          }
          document.getElementById('tigst14').innerHTML = data2 + ' % IGST';
          document.getElementById('tigst14').value = data2

        }
      });

    });

    $(document).on('click', '#item15', function () {
      select = $('#item15').val();
      customer = $('#customer_sel').val();
      console.log(select);
      console.log(customer);
      $.ajax({
        type: "GET",
        url: "{% url 'itemdata_est' %}",
        data: {
          id: select,
          cust: customer
        },
        success: function (response) {
          console.log(response)
          data = response.rate
          data1 = response.gst
          data2 = response.igst
          data3 = response.pos
          document.getElementById('rate15').value = data

          if (data3 == '{{ company.state }}') {
            document.getElementById('tgst15').innerHTML = data1 + ' % GST';
            document.getElementById('tgst15').value = data1
          }
          document.getElementById('tigst15').innerHTML = data2 + ' % IGST';
          document.getElementById('tigst15').value = data2

        }
      });

    });

    $(document).on('click', '#item16', function () {
      select = $('#item16').val();
      customer = $('#customer_sel').val();
      console.log(select);
      console.log(customer);
      $.ajax({
        type: "GET",
        url: "{% url 'itemdata_est' %}",
        data: {
          id: select,
          cust: customer
        },
        success: function (response) {
          console.log(response)
          data = response.rate
          data1 = response.gst
          data2 = response.igst
          data3 = response.pos
          document.getElementById('rate16').value = data

          if (data3 == '{{ company.state }}') {
            document.getElementById('tgst16').innerHTML = data1 + ' % GST';
            document.getElementById('tgst16').value = data1
          }
          document.getElementById('tigst16').innerHTML = data2 + ' % IGST';
          document.getElementById('tigst16').value = data2

        }
      });

    });

    $(document).on('click', '#item17', function () {
      select = $('#item17').val();
      customer = $('#customer_sel').val();
      console.log(select);
      console.log(customer);
      $.ajax({
        type: "GET",
        url: "{% url 'itemdata_est' %}",
        data: {
          id: select,
          cust: customer
        },
        success: function (response) {
          console.log(response)
          data = response.rate
          data1 = response.gst
          data2 = response.igst
          data3 = response.pos
          document.getElementById('rate17').value = data

          if (data3 == '{{ company.state }}') {
            document.getElementById('tgst17').innerHTML = data1 + ' % GST';
            document.getElementById('tgst17').value = data1
          }
          document.getElementById('tigst17').innerHTML = data2 + ' % IGST';
          document.getElementById('tigst17').value = data2

        }
      });

    });

    $(document).on('click', '#item18', function () {
      select = $('#item18').val();
      customer = $('#customer_sel').val();
      console.log(select);
      console.log(customer);
      $.ajax({
        type: "GET",
        url: "{% url 'itemdata_est' %}",
        data: {
          id: select,
          cust: customer
        },
        success: function (response) {
          console.log(response)
          data = response.rate
          data1 = response.gst
          data2 = response.igst
          data3 = response.pos
          document.getElementById('rate18').value = data

          if (data3 == '{{ company.state }}') {
            document.getElementById('tgst18').innerHTML = data1 + ' % GST';
            document.getElementById('tgst18').value = data1
          }
          document.getElementById('tigst18').innerHTML = data2 + ' % IGST';
          document.getElementById('tigst18').value = data2

        }
      });

    });

    $(document).on('click', '#item19', function () {
      select = $('#item19').val();
      customer = $('#customer_sel').val();
      console.log(select);
      console.log(customer);
      $.ajax({
        type: "GET",
        url: "{% url 'itemdata_est' %}",
        data: {
          id: select,
          cust: customer
        },
        success: function (response) {
          console.log(response)
          data = response.rate
          data1 = response.gst
          data2 = response.igst
          data3 = response.pos
          document.getElementById('rate19').value = data

          if (data3 == '{{ company.state }}') {
            document.getElementById('tgst19').innerHTML = data1 + ' % GST';
            document.getElementById('tgst19').value = data1
          }
          document.getElementById('tigst19').innerHTML = data2 + ' % IGST';
          document.getElementById('tigst19').value = data2

        }
      });

    });

    $(document).on('click', '#item20', function () {
      select = $('#item20').val();
      customer = $('#customer_sel').val();
      console.log(select);
      console.log(customer);
      $.ajax({
        type: "GET",
        url: "{% url 'itemdata_est' %}",
        data: {
          id: select,
          cust: customer
        },
        success: function (response) {
          console.log(response)
          data = response.rate
          data1 = response.gst
          data2 = response.igst
          data3 = response.pos
          document.getElementById('rate20').value = data

          if (data3 == '{{ company.state }}') {
            document.getElementById('tgst20').innerHTML = data1 + ' % GST';
            document.getElementById('tgst20').value = data1
          }
          document.getElementById('tigst20').innerHTML = data2 + ' % IGST';
          document.getElementById('tigst20').value = data2

        }
      });

    });

    $(document).on('click', '#item21', function () {
      select = $('#item21').val();
      customer = $('#customer_sel').val();
      console.log(select);
      console.log(customer);
      $.ajax({
        type: "GET",
        url: "{% url 'itemdata_est' %}",
        data: {
          id: select,
          cust: customer
        },
        success: function (response) {
          console.log(response)
          data = response.rate
          data1 = response.gst
          data2 = response.igst
          data3 = response.pos
          document.getElementById('rate21').value = data

          if (data3 == '{{ company.state }}') {
            document.getElementById('tgst21').innerHTML = data1 + ' % GST';
            document.getElementById('tgst21').value = data1
          }
          document.getElementById('tigst21').innerHTML = data2 + ' % IGST';
          document.getElementById('tigst21').value = data2

        }
      });

    });


  });
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>



<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

{% endblock %}