{% extends 'base.html' %}
{% load static %}
{% block content %}

<style>
    .modal{
      z-index: 9999;
      overflow: scroll;
    }
    select:focus {
        outline: none !important;
        box-shadow: none !important;
    }

    #customer_sel option:hover {
        background-color: rgb(210, 132, 30);
    }

    .element-below-fixed {
        padding-top: 100px;
    }

    /* width */
    ::-webkit-scrollbar {
        width: 10px;
    }

    /* Track */
    ::-webkit-scrollbar-track {
        background: #f1f1f1;
    }

    /* Handle */
    ::-webkit-scrollbar-thumb {
        background: #888;
    }

    /* Handle on hover */
    ::-webkit-scrollbar-thumb:hover {
        background: #555;
    }
</style>
<script>
    window.onload=function(){        
        var ste="{{ comp }}";
        var plc="{{ cust }}";
        var x=ste.toLowerCase(); 
        var inputstring=plc;
        document.getElementById("cus_place1").value=plc;
        document.getElementById("cus_place_second").value=plc;
        const parts = inputstring.split("-");   
        var extractedWord = parts[1];  
        var extractedWord1= extractedWord.trim();
        var y=extractedWord1.toLowerCase();  
        document.getElementById("cus_place").value=y;
        document.getElementById("state").value=x;
        document.getElementById("customer_mail").value="{{cust_email}}"
        document.getElementById("customer_id").value="{{ cust_id }}";
        document.getElementById("customer_gst_treat").value="{{ cust_gst_treat }}";
        document.getElementById("customer_gstno").value="{{ cust_gstno }}";

        var GSTNO=document.getElementById('customer_gstno').value;
              var expr=/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/;

              if (!expr.test(GSTNO)) 
              {
                $("#cgstno_row").removeClass('d-flex');
                $("#cgstno_row").addClass('d-none');
             }
           else{
                $("#cgstno_row").removeClass('d-none');
                $("#cgstno_row").addClass('d-flex');
              }

        
        var ig="{{ estimate.igst }}";
        var cg="{{ estimate.cgst }}";
        var sg="{{ estimate.sgst }}";
        if ( x == y )
                                {
                                   document.getElementById("item_table").style.display="block"
                                   document.getElementById("item_tablee").style.display="none"
                                   document.getElementById("label_tab1").style.display="block"
                                   document.getElementById("label_tab2").style.display="none"
                                   document.getElementById("add-row").style.display="block"
                                   document.getElementById("add-roww").style.display="none"
                                    
                        
                                }
                                else
                                {
                                   document.getElementById("item_table").style.display="none"
                                   document.getElementById("item_tablee").style.display="block"
                                   document.getElementById("label_tab1").style.display="none"
                                   document.getElementById("label_tab2").style.display="block"
                                   document.getElementById("add-row").style.display="none"
                                   document.getElementById("add-roww").style.display="block"
                                }

          if ( ig != 0 ){
        document.getElementById("tr_igst").style.display = "table-row";
            document.getElementById("tr_sgst").style.display = "none";
            document.getElementById("tr_cgst").style.display = "none";

      }
      else{

        document.getElementById("tr_cgst").style.display = "table-row";
            document.getElementById("tr_sgst").style.display = "table-row";
            document.getElementById("tr_igst").style.display = "none";
      }
                    
    }
</script>
<script>
    function cust_mail(){
        var customer= document.getElementById("customer_sel").value
        var table = document.getElementById("item_table");
        
        $.ajax({
                type: "GET",
                url: "{% url 'get_cust_mail' %}",
                data: {
                 
                    cust: customer
                },
                success: function (response) {
                    console.log(response)
                    data = response.email
                    data1=response.cust_id
                    data2=response.cust_place_supply                            
                }
            });
    }
</script>











<script>



function calc(){
        var x=document.getElementById("cus_place").value
        var y=document.getElementById("state").value
        
    if ( x == y )
    {
        $('#item_table tbody tr').each(function () {
            var html = $(this).html();
            if (html != '') {
                console.log('rows');
                var qty = $(this).find('.qty').val();
                var rate = $(this).find('.rate').val();
                var discount = $(this).find('.discount').val();
                var ttax = $(this).find('.tax').val();
                var tax=parseInt(ttax);
                

                $(this).find('.taxamount').val((qty * rate - discount) * (tax / 100));
                var taxamount = parseFloat($(this).find('.taxamount').val());
                $(this).find('.amount').val(qty * rate - discount);
                // $(this).find('.taxamount').val((qty * rate) * (tax / 100));
                // var taxamount = parseFloat($(this).find('.taxamount').val());
                // $(this).find('.amount').val(qty * rate - discount);

                calc_total();
            }
        });
    }
    else
    {
        $('#item_tablee tbody tr').each(function () {
            var html = $(this).html();
            if (html != '') {
                console.log('rows');
                var qtyy = $(this).find('.qtyy').val();
                var ratee = $(this).find('.ratee').val();
                var discountt = $(this).find('.discountt').val();
                var ttaxx = $(this).find('.taxx').val();
                var taxx=parseInt(ttaxx);

                $(this).find('.taxamountt').val((qtyy * ratee - discountt) * (taxx / 100));
                var taxamountt = parseFloat($(this).find('.taxamountt').val());
                $(this).find('.amountt').val(qtyy * ratee - discountt);
                
                // $(this).find('.taxamountt').val((qtyy * ratee) * (taxx / 100));
                // var taxamountt = parseFloat($(this).find('.taxamountt').val());
                // $(this).find('.amountt').val(qtyy * ratee - discountt);

                calc_total();
            }
        });
    }
}

    function calc_total() {
        var x=document.getElementById("cus_place").value
        var y=document.getElementById("state").value
        if ( x== y )
        {
            total = 0;
        $('.amount').each(function () {
            total += parseFloat($(this).val());
        });
        taxamount = 0;
        $('.taxamount').each(function () {
            taxamount += parseFloat($(this).val());
        });

        $('#subtotal').val(total.toFixed(2));
        $('#total_taxamount').val(taxamount.toFixed(2));

        $('#total').val((taxamount + total ).toFixed(2));
        // $('#baldue').val((taxamount + total).toFixed(2));

        test();
        calc_ship();

        }
        else
        {
            total = 0;
        $('.amountt').each(function () {
            total += parseFloat($(this).val());
        });
        taxamount = 0;
        $('.taxamountt').each(function () {
            taxamount += parseFloat($(this).val());
        });

        $('#subtotal').val(total.toFixed(2));
        $('#total_taxamount').val(taxamount.toFixed(2));

        $('#total').val((taxamount + total ).toFixed(2));
        // $('#baldue').val((taxamount + total).toFixed(2));

        test();
        calc_ship();

        }
        
    }

    function test() {
        console.log('test');
        d = 0;
        // var pos = $("#customer_sel option:selected").data("pos");
        var pos=document.getElementById("cus_place").value;
        var state = document.getElementById("state").value;

        if (pos == state) {
            console.log(pos);
            console.log(state);
            console.log(taxamount);
            gst = taxamount / 2;
            console.log(gst);
            $('#cgst').val(parseFloat(gst.toFixed(2)));
            $('#sgst').val(parseFloat(gst.toFixed(2)));
            $('#igst').val(parseFloat(d.toFixed(2)));
            document.getElementById("tr_cgst").style.display = "table-row";
            document.getElementById("tr_sgst").style.display = "table-row";
            document.getElementById("tr_igst").style.display = "none";

        }

        if (pos != state) {
            console.log(pos);
            console.log(state);
            $('#igst').val(taxamount.toFixed(2));
            $('#cgst').val(d.toFixed(2));
            $('#sgst').val(d.toFixed(2));
            document.getElementById('tr_igst').style.display = "table-row";
            document.getElementById("tr_sgst").style.display = "none";
            document.getElementById("tr_cgst").style.display = "none";
        }
    }


    function calc_ship()
    {
        var shipping_charge=parseFloat($('#shipping_charge').val());
        var adjustment_charge=parseFloat($('#adjustment_charge').val());
        var subtotal=parseFloat($('#subtotal').val());
        var total_tax=parseFloat($('#total_taxamount').val());
        var total=subtotal + total_tax + shipping_charge + adjustment_charge;

        $('#shipping_charge').val(shipping_charge.toFixed(2));
            $('#adjustment_charge').val(adjustment_charge.toFixed(2));
            $('#total').val(total.toFixed(2));


    }



</script>



<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script>
    $(document).ready(function () {
        $('[data-toggle="tooltip"]').tooltip();
    });
</script>
<section>
    <div style="top: 7rem; ">
        <div class="row  ml-2">
            <div class="col-md-3 "><a class="text-white" style="font-size: 1.5rem;"><i class="fa-solid fa-plus"></i> Edit 
                    Estimate</a></div>
            <!-- <input type="hidden" id="state" value="{{ company.state }}"> -->
        </div>

        <div >
            <form method="post" action="{% url 'updateestimate' estimate.id %}" class="p-5" enctype="multipart/form-data" novalidate
                id="forms">
                {% csrf_token %}
                <input class="hidden"  id="state1" name="hidden_state1" value="{{ company.state }}">
                <input class="hidden"  id="state" name="hidden_state" value="">
                <input class="hidden" type="text" name="samp" id="samp">
                <input class="hidden"  id="cus_place" name="hidden_cus_place"  value="">
                <input type="number" id="customer_id" name="customer_id" style="display: none;"  readonly>
          
                <div class="row mb-4 border-top pt-5">
                    <div class="col-sm-2"><label for="customer_name">Customer Name*</label></div> 
                    <div class="col-sm-6">
                        <select class="form-control text-black" id="customer_sel" name="customer_name" >
                            <option value="{{estimate.customer.id}} {{estimate.customer_name}}">{{estimate.customer_name}}</option>
                            {% for cust in customers %}
                            <option value="{{cust.id}} {{cust.customerName}}" data-pos="{{cust.placeofsupply}}">
                                {{cust.customerName}}</option>
                            {% endfor %}
                        </select>

                       
                    </div> 
                    <div class="col-sm-4">
                        <a  href="" data-toggle="modal" data-target="#newcustomer"><i class="fa-solid  fa fa-plus p-2 rounded"
                            style="color: white; background-color: rgb(210, 132, 30);height: 37px;"></i></a>
                    </div>
                </div>
                <div class="row mb-4 " id="cemail_row" >
                  <div class="col-sm-2"><label for="estimate_number">Customer Mail ID</label></div>
                  <div class="col-sm-6"><input type="text" id="customer_mail" name="customer_mail" class="form-control text-dark"
                          value="" readonly>
                      
                  </div>
              </div>

              <div class="row mb-4 " id="cgst_treat_row" >
                <div class="col-sm-2"><label for="">GST Treatment</label></div>
                <div class="col-sm-6"><input type="text" id="customer_gst_treat" name="" class="form-control text-dark"
                        value="" readonly>
                    
                </div>
            </div>
            <div class="row mb-4 d-none" id="cgstno_row" >
              <div class="col-sm-2 col-lg-2 col-md-2"><label for="">GST Number</label></div>
              <div class="col-sm-6 col-lg-6 col-md-6"><input type="text" id="customer_gstno" name="" class="form-control text-dark"
                      value="" readonly>
                  
              </div>
          </div>
          <div class="row mb-4" id="cplace_supply_row" >
            <div class="col-sm-2"><label for="">Place Of Supply</label></div>
            <div class="col-sm-6">
              <!-- <input type="text" id="cus_place1" name="" class="form-control text-dark"
                    value="" readonly> -->
                    <select class="form-control text-dark bg-light" id="cus_place1" name="cus_place1" onclick="place_of_supply()">
                      <option value="[AN]-Andaman and Nicobar Islads">[AN] Andaman and Nicobar Islads</option>
                      <option value="[AD]-Andhra Predhesh">[AD] Andhra Predhesh</option>
                      <option value="[AR]-Arunachal Predesh">[AR] Arunachal Predesh</option>
                      <option value="[AS]-Assam">[AS] Assam</option>
                      <option value="[BR]-Bihar">[BR] Bihar</option>
                      <option value="[CH]-Chandigarh">[CH] Chandigarh</option>
                      <option value="[CG]-Chhattisgarh">[CG] Chhattisgarh</option>
                      <option value="[DNH]-Dadra and Nagar Haveli">[DNH] Dadra and Nagar Haveli</option>
                      <option value="[DD]-Damn anad Diu">[DD] Damn anad Diu</option>
                      <option value="[DL]-Delhi">[DL] Delhi</option>
                      <option value="[GA]-Goa">[GA] Goa</option>
                      <option value="[GJ]-Gujarat">[GJ] Gujarat</option>
                      <option value="[HR]-Haryana">[HR] Haryana</option>
                      <option value="[HP]-Himachal Predesh">[HP] Himachal Predesh</option>
                      <option value="[JK]-Jammu and Kashmir">[JK] Jammu and Kashmir</option>
                      <option value="[JH]-Jharkhand">[JH] Jharkhand</option>
                      <option value="[KA]-Karnataka">[KA] Karnataka</option>
                      <option value="[KL]-Kerala">[KL] Kerala</option>
                      <option value="[LA]-Ladakh">[LA] Ladakh</option>
                      <option value="[LD]-Lakshadweep">[LD] Lakshadweep</option>
                      <option value="[MP]-Madhya Predesh">[MP] Madhya Predesh</option>
                      <option value="[MH]-Maharashtra">[MH] Maharashtra</option>
                      <option value="[MN]-Manipur">[MN] Manipur</option>
                      <option value="[ML]-Meghalaya">[ML] Meghalaya</option>
                      <option value="[MZ]-Mizoram">[MZ] Mizoram</option>
                      <option value="[NL]-Nagaland">[NL] Nagaland</option>
                      <option value="[OD]-Odisha">[OD] Odisha</option>
                      <option value="[PY]-Puducherry">[PY] Puducherry</option>
                      <option value="[PB]-Punjab">[PB] Punjab</option>
                      <option value="[RJ]-Rajasthan">[RJ] Rajasthan</option>
                      <option value="[SK]-Sikkim">[SK] Sikkim</option>
                      <option value="[TN]-Tamil Nadu">[TN] Tamil Nadu</option>
                      <option value="[TS]-Telangana">[TS] Telangana</option>
                      <option value="[TR]-Tripura">[TR] Tripura</option>
                      <option value="[UP]-Uttar Predesh">[UP] Uttar Predesh</option>
                      <option value="[UK]-Uttarakhand">[UK] Uttarakhand</option>
                      <option value="[WB]-West Bengal">[WB] West Bengal</option>
                      <option value="[OT]-Other Territory">[OT] Other Territory</option>
                    </select>
                    <input  type="text" id="cus_place_second" name="" class="form-control text-dark hidden"  value="">
                
            </div>
        </div>
                
                <div class="row mb-4">
                    <div class="col-sm-2"><label for="estimate_number">Estimate#*</label></div>
                    <div class="col-sm-6"><input type="text" id="estimate_number" name="estimate_number" class="form-control text-black"
                            value="{{estimate.estimate_no}}" >
                        
                    </div>
                </div>
                
                <div class="row mb-4">
                    <div class="col-sm-2"><label for="reference">Reference#</label></div>
                    <div class="col-sm-6"> <input type="number" id="reference" name="reference" class="form-control text-black"
                        value="{{estimate.reference}}"></div>
                </div>

                <div class="row mb-4 border-bottom pb-5">
                    <div class="col-sm-2"><label for="reference">Estimate Date*</label></div>
                    <div class="col-sm-2"> <input type="date" id="estimate_date" name="estimate_date" class="form-control text-black"
                        value="{{estimate.estimate_date|date:'Y-m-d'}}" style="width: 100%;height: 35px;">
                    </div>
                    <div class="col-sm-2 text-right"><label for="reference">Expiry Date</label></div>
                    <div class="col-sm-2"> <input type="date" id="expiry_date" name="expiry_date" class="form-control text-black"
                        value="{{estimate.expiry_date|date:'Y-m-d'}}" style="width: 100%;height: 35px;"></div>
                </div>
<!-- ...........................................................  TABLE 1    ....................................... -->
                <div class="row">
                    <div class="col-sm-12 col-md-12 col-lg-12">
                        <label for="" id="label_tab1">Price List</label><br>
                   <table class="table text-black table-bordered" id="item_table" style="background-color: rgba(250, 227, 198, 0.8);table-layout: fixed;width: 100%;background-color: #b6b3b36b;"
                    onchange="calc()">
                    <thead>
                        <tr>
                            <th class="" style="font-weight: bold;color: rgb(245, 154, 36);">Items <a href="" data-toggle="modal" data-target="#newitem"><i class="fas fa-plus p-2 rounded"
                                style="color: white; background-color: rgb(210, 132, 30);"></i></a></th>
                                <th class="text-right" style="font-weight: bold;color: rgb(245, 154, 36);">Hsn</th>
                                <th class="text-right " style="font-weight: bold;color: rgb(245, 154, 36);">Quantity</th>
                            <th class="text-right " style="font-weight: bold;color: rgb(245, 154, 36);">Rate</th>
                            <th class="text-right " style="font-weight: bold;color: rgb(245, 154, 36);">Discount</th>
                            <th class="text-right " style="font-weight: bold;color: rgb(245, 154, 36);">Tax</th>
                            <th class="text-right " style="font-weight: bold;color: rgb(245, 154, 36);">Amount</th>
                        </tr>
                    </thead>
                    <tbody>
                       {% for item in est_items %}
                        <tr id='row{{ forloop.counter }}'>
                            <td style="width: 5%;">
                                <div class='form-group'><select
                                        class='form-control bg-transparent text-light border-0 item_select itm'
                                        name='item[]' id='item{{ forloop.counter }}'>
                                        <option class='text-dark' value="{{item.item_name}}">{{item.item_name}}</option>
                                        {% for i in items %}
                                        <option class="text-dark" value="{{i.Name}}">{{i.Name}}</option>
                                        {% endfor %}
                                    </select></div>
                            </td>
                            <td class='text-right' style="width: 18%;"><input type='number' id='hsn{{ forloop.counter }}'
                              class='form-control bg-transparent border-0 text-light text-right hsn' name='hsn[]'
                              value='{{item.hsn}}' readonly>
                            </td>
                            <td class='text-right' ><input type='number' id='qty{{ forloop.counter }}'
                                    class='form-control bg-transparent border-0 text-light text-right qty' name='quantity[]'
                                    value='{{item.quantity}}'>
                                   
                            </td>
                            <td class='text-right' style="width: 15%;"><input type='number' id='rate{{ forloop.counter }}'
                                    class='form-control bg-transparent border-0 text-light text-right rate' name='rate[]'
                                    value='{{item.rate}}'>
                            </td>

                            <td class='text-right' style="width: 15%;"><input type='number' id='discount{{ forloop.counter }}'
                                    class='form-control bg-transparent border-0 text-light text-right discount' name='discount[]'
                                    value='{{item.discount}}'>
                            </td>

                            <td class='text-right' style="width: 18%;"> 
                                <select name='tax[]' id='tax{{ forloop.counter }}'
                                    class='form-control bg-transparent text-light text-right border-0 tax'>
                                    <option value='{{item.tax_percentage}}' class="text-dark">{{item.tax_percentage}} %</option>
                                    <option value=0 class="text-dark">0% GST</option>
                                    <option value=3 class="text-dark">3% GST</option>
                                    <option value=5 class="text-dark">5% GST</option>
                                    <option value=12 class="text-dark">12% GST</option>
                                    <option value=18 class="text-dark">18% GST</option>
                                    <option value=28 class="text-dark">28% GST</option> 
                                </select>
                            </td>
                            <td style="display: none;">
                                <input type="number" name='taxamount[]' id="taxamount{{ forloop.counter }}"
                                    class="form-control taxamount" />
                            </td>
                            <td class='text-right' style="width: 20%;"><input type='number' id='amount{{ forloop.counter }}'
                                    class='form-control bg-transparent border-0 text-light text-right  amount ' name='amount[]'
                                    value='{{item.amount}}'  readonly></td>
                            <td class='text-center'><button type='button' id='del_btn{{ forloop.counter }}'
                                    class='btn btn-transparent text-danger btn-sm btn-outline-danger rounded-circle delete-row'
                                    style='width:30px'><i class='fa fa-times'></i></button>
                                    <button type='button' class='btn btn-transparent text-primary btn-sm btn-outline-primary rounded-circle clone-row' data-row=1 style='width:30px'><i class="fa fa-clone"></i>
                                    </button>
                                </td>
                                    
                        </tr>
                        {% endfor %}
                    </tbody>

                </table>
                <button type="button" class="btn btn-sm text-white" style="background-color: rgb(210, 132, 30) ;"
                    id="add-row"><i class="fa-solid  fa fa-plus rounded"
                    style="color: white; background-color: rgb(210, 132, 30);height: 20px;"></i></button>
                    </div>
                </div>

 <!-- ......................................................  END TABLE 1.........................................                -->

<!-- ...................................................  TABLE 2  ..................................................... -->

<div class="row">
    <div class="col-sm-12 col-md-12 col-lg-12">
        <label for="" id="label_tab2" style="display: none;">Price List</label><br>
   <table class="table  text-black table-bordered" id="item_tablee" style="background-color: rgba(250, 227, 198, 0.8);table-layout: fixed;width: 100%;background-color: #b6b3b36b;display: none;"
    onchange="calc()">
    <thead>
        <tr>
            <th class="" style="color: rgb(245, 154, 36);font-weight: bold;">Items<a href="" data-toggle="modal" data-target="#newitem"><i class="fas fa-plus p-2 rounded"
                style="color: white; background-color: rgb(210, 132, 30);"></i></a></th>
                <th class="text-right" style="font-weight: bold;color: rgb(245, 154, 36);">Hsn</th>
                <th class="text-right " style="color: rgb(245, 154, 36);font-weight: bold;">Quantity</th>
            <th class="text-right " style="color: rgb(245, 154, 36);font-weight: bold;">Rate</th>
            <th class="text-right " style="color: rgb(245, 154, 36);font-weight: bold;">Discount</th>
            <th class="text-right " style="color: rgb(245, 154, 36);font-weight: bold;">Tax</th>
            <th class="text-right " style="color: rgb(245, 154, 36);font-weight: bold;">Amount</th>
        </tr>
    </thead>
    <tbody>
       {% for item in est_items %}
        <tr id='row{{ forloop.counter }}'>
            <td >
                <div class='form-group'><select
                        class='form-control bg-transparent text-light border-0 item_selectt itmm'
                        name='itemm[]' id='itemm{{ forloop.counter }}' style="width: 100%;">
                        <option class='text-dark' value="{{item.item_name}}">{{item.item_name}}</option>
                        {% for i in items %}
                        <option class="text-dark" value="{{i.Name}}">{{i.Name}}</option>
                        {% endfor %}
                    </select></div>
            </td>
            <td class='text-right' style="width: 15%;"><input type='number' style="width: 100%;" id='hsnn{{ forloop.counter }}'
              class='form-control bg-transparent border-0 text-light text-right hsnn' name='hsnn[]'
              value='{{item.hsn}}' readonly>
            </td>
            <td class='text-right' style="width: 10%;"><input type='number' style="width: 100%;" id='qtyy{{ forloop.counter }}'
                    class='form-control bg-transparent border-0 text-light text-right qtyy' name='quantityy[]'
                    value='{{item.quantity}}'>
            </td>
            <td class='text-right' style="width: 15%;"><input type='number' style="width: 100%;" id='ratee{{ forloop.counter }}'
                    class='form-control bg-transparent border-0 text-light text-right ratee' name='ratee[]'
                    value='{{item.rate}}'>
            </td>
            <td class='text-right' ><input type='number' style="width: 100%;" id='discountt{{ forloop.counter }}'
                    class='form-control bg-transparent border-0 text-light text-right discountt' name='discountt[]'
                    value='{{item.discount}}'>
            </td>
            <td class='text-right' style="width: 15%;"> 
                <select name='taxx[]' style="width: 100%;" id='taxx{{ forloop.counter }}'
                    class='form-control bg-transparent text-light text-right border-0 taxx'>
                    <option value='{{item.tax_percentage}}'>{{item.tax_percentage}} %</option>
                    <option value=0 class="text-dark">0% IGST</option>
                    <option value=3 class="text-dark">3% IGST</option>
                    <option value=5 class="text-dark">5% IGST</option>
                    <option value=12 class="text-dark">12% IGST</option>
                    <option value=18 class="text-dark">18% IGST</option>
                    <option value=28 class="text-dark">28% IGST</option> 
                </select>
            </td>
            <td style="display: none;">
                <input type="number" name='taxamountt[]' id="taxamountt{{ forloop.counter }}"
                    class="form-control taxamountt" />
            </td>
            <td class='text-right'><input type='number' style="width: 100%;" id='amountt{{ forloop.counter }}'
                    class='form-control bg-transparent border-0 text-light text-right amountt' name='amountt[]'
                    value='{{item.amount}}' readonly></td>
            <td class='text-center'><button type='button' id='del_btnn{{ forloop.counter }}'
                    class='btn btn-transparent text-danger btn-sm btn-outline-danger rounded-circle delete-roww'
                    style='width:30px'><i class='fa fa-times'></i></button>
                    <button type='button' class='btn btn-transparent text-primary btn-sm btn-outline-primary rounded-circle clone-roww' data-row=1 style='width:30px'><i class="fa fa-clone"></i>
                    </button>
                </td>
                    
        </tr>
        {% endfor %}
    </tbody>

</table>
<button type="button" class="btn btn-sm text-white" style="background-color: rgb(210, 132, 30) ;display: none;"
    id="add-roww"><i class="fa-solid  fa fa-plus rounded"
    style="color: white; background-color: rgb(210, 132, 30);height: 20px;"></i></button>
    </div>
</div>


<!-- ..................................................   END TABLE 2   .......................................................... -->



                <div class="row border-bottom pb-5 mt-4">
                    <div class="col-sm-12 col-md-6 col-lg-6">

                        <label for="">Customer Notes</label>
                        <textarea name="customer_note" id="" class="form-control text-dark"
                        placeholder="Customer notes" style="height: 50%;">{{ estimate.customer_notes}}</textarea>
                    </div>
                    <div class="col-sm-12 col-md-6 col-lg-6">
                        <div style="width: 100%;">
                            <table class="rounded table  text-black table-bordered" style="background-color: rgba(141, 140, 139, 0.507);table-layout: fixed;">
                                <tr style="font-weight: bold;">
                                    <td>Sub Total</td>
                                    <td><input type="text" id="subtotal" name="subtotal" value="{{estimate.sub_total}}"
                                            class="bg-transparent border-0 text-right text-light form-control" step="any" style="width: 50%;"></td>
                                </tr>
                                <tr style="display: none;font-weight: bold;" id="tr_igst" style="width: 50%;">
                                    <td>IGST</td>
                                    <td><input type="number" id='igst' name="igst" value="{{ estimate.igst }}" step="any"
                                            class=" form-control border-0 text-right text-light bg-transparent" style="width: 50%;"></td>
                                </tr>
                                <tr style="display: none;font-weight: bold;" id="tr_cgst">
                                    <td>CGST</td>
                                    <td><input type="number" id='cgst' name="cgst" value="{{ estimate.cgst }}" step="any"
                                            class="form-control bg-transparent border-0 text-right text-light" style="width: 50%;"></td>
                                </tr>
                                <tr style="display: none;font-weight: bold;" id="tr_sgst">
                                    <td>SGST</td>
                                    <td><input type="number" id='sgst' name="sgst" value="{{ estimate.sgst }}" step="any"
                                            class="form-control bg-transparent border-0 text-right text-light" style="width: 50%;"></td>
                                </tr>
                                <tr style="font-weight: bold;">
                                    <td>Tax Amount</td>
                                    <td><input type="text" id="total_taxamount" name="total_taxamount" value="{{estimate.tax_amount}}"
                                            class="form-control bg-transparent border-0 text-right text-light" step="any" style="width: 50%;"></td>
                                </tr>
                                <tr style="font-weight: bold;">
                                    <td>Shipping Charges</td>
                                    <td><input type="number" id="shipping_charge" name="shipping_charge" value="{{estimate.shipping_charge}}"
                                            class="form-control bg-transparent border-0 text-right text-light shipping_charge" onchange="calc_ship()" step="any" style="width: 50%;"></td>
                                </tr>
                                <tr style="font-weight: bold;">
                                    <td>Adjustmment</td>
                                    <td><input type="number" id="adjustment_charge" name="adjustment_charge" value="{{estimate.adjustment}}"
                                            class="form-control bg-transparent border-0 text-right adjustment text-light" onchange="calc_ship()" step="any" style="width: 50%;"> </td>
                                </tr>
                                <tr style="font-weight: bold;">
                                    <th style="color: rgb(245, 161, 5);">Total ( &#x20B9; )</th>
                                    <th><input type="text" id="total" name="total" value="{{estimate.total}}"
                                            class="form-control bg-transparent border-0 text-right" step="any" style="color:rgb(240, 158, 6);" readonly></th>
                                </tr>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- <div class="row py-5 border-bottom">
                    <div class="col-md-6 d-flex flex-column w-60 text-black">
                        <label for="">Terms & Conditions</label>
                        <textarea name="terms_conditions" id="" cols="20" rows="5"
                            placeholder=" Enter the terms & conditions of your business to be displayed in your transaction."></textarea>
                    </div>
                    <div class="col-md-6 py-5 text-center rounded" style="background-color: rgba(250, 227, 198, 0.8);">
                        <label class="text-dark" for="">Attach File(s) to Estimate</label><br>

                        <label for="file-upload" class="btn text-white border-0"
                            style="background-color: rgb(210, 132, 30);">
                            <i class="fas fa-upload text-white"></i> Upload File
                        </label>
                        <input id="file-upload" type="file" name="file" style="display:none;">



                    </div>
                </div> -->
                <div class="row  border-bottom">
                    <div class="col-md-6 col-lg-6 col-sm-12 py-5">
                        <label for="">Terms & Conditions</label>
                        <textarea class="form-control text-dark" style="height: 100%;" rows="6"  name="terms_conditions" id="" 
                            placeholder=" Enter the terms & conditions of your business to be displayed in your transaction.">{{ estimate.terms_conditions }}</textarea>
                    </div>
                    <div class="col-md-6 col-lg-6 col-sm-12 py-5 text-center rounded mt-4" >
                        <div  style="width: 100%;background-color: rgba(153, 152, 152, 0.507);height: 120px;">
                            <label class="text-black mt-3 pt-3" for="">Attach File(s) to Estimate</label><br>

                        <label for="file-upload" class="btn text-white border-0"
                            style="background-color: rgb(210, 132, 30);">
                            <i class="fas fa-upload text-white"></i> Upload File
                        </label>
                        <input class="pb-3"  id="file-upload" type="file" name="file" style="display:none;">
                        </div>



                    </div>
                </div>

                <input type="submit" class="btn text-white mt-5" style="background-color:  rgb(210, 132, 30) ; "
                     value="Save">
                
            </form>


             <!-- customer modal -->


    <div class="modal fade" id="newcustomer">
        <div class="modal-dialog modal-xl">
          <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
            <div class="modal-header " style="background: rgb(32, 35, 37);">
                <h3 class="m-3 text-uppercase">New Customer</h3>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body" style="background: rgb(32, 35, 37);">
              <div class="card p-3 m-3">
                <form action="" method="post" class="needs-validation" novalidate autocomplete="off" id="modalCustomer">
          
                  <div class="row mt-2">
                    <div class="col-md-3 mt-2">
                      <label for="">Customer Type</label><br>
                    </div>
                    <div class="col-md-6 mt-2">
                      <div class="d-flex">
                        <div class="radio_opt mx-5 mt-2">
                          <input type="radio" id="business" name="radioCust" value="Business" >
                          <label for="option1">Business</label>
                        </div>
                        <div class="radio_opt mx-4 mt-2">
                          <input type="radio" id="individual" name="radioCust" value="Individual" >
                          <label for="option2">Individual</label>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="row mt-5">
                    <div class="col-md-3">
                      <label for="ctitle">Title</label>
                    </div>
                    <div class="col-md-3">
                      <select name="ctitle" id="ctitle" class="form-control text-dark bg-light">
                        <option value="Mr." selected>Mr.</option>
                        <option value="Mrs.">Mrs.</option>
                        <option value="Ms.">Ms.</option>
                        <option value="Miss.">Miss.</option>
                        <option value="Dr.">Dr.</option>
                      </select>
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-md-3 mt-2">
                      <label for="cfname">First name</label>
                    </div>
                    <div class="col-md-6 mt-2">
                      <input type="text" class="form-control text-dark bg-light" id="cfname" name="cfirstname" required>
                    </div>
                  </div>
                  <div class="row mt-2">
                    <div class="col-md-3 mt-2">
                      <label for="clname">Last name</label>
                      <label id="cdisplayname" name = "cdisplayname" hidden></label>
                    </div>
                    <div class="col-md-6 mt-2">
                      <input type="text" class="form-control text-dark bg-light" id="clname" name="clastname">
                    </div>
                  </div>
  
                  <div class="row mt-2">
                    <div class="col-md-3 mt-2">
                      <label for="ccompany">Company Name</label>
                    </div>
                    <div class="col-md-6 mt-2">
                      <input type="text" class="form-control text-dark bg-light" id="ccompany" name="ccompany_name">
                    </div>
                  </div>
  
                  <div class="row mt-2">
                    <div class="col-md-3 mt-2">
                      <label for="cemail">Customer Email</label>
                    </div>
                    <div class="col-md-6 mt-2">
                      <input type="email" class="form-control text-dark bg-light" id="cemail" name="cemail" placeholder="example@gmail.com" pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}$">    
                    </div>              
                  </div>
  
                  <div class="row mt-2">
                    <div class="col-md-3 mt-2">
                      <label for="email">Customer Phone</label>
                    </div>
                    <div class="col-md-3 mt-2">
                      <input type="text" class="form-control text-dark bg-light" id="cw_mobile" placeholder="Work Number" maxlength="10" name="cw_mobile">
                    </div>        
                    <div class="col-md-3 mt-2">
                      <input type="text" class="form-control text-dark bg-light" id="cp_mobile" placeholder="Personal Number" maxlength="10" name="cp_mobile">
                    </div>          
                  </div>
  
             
                  <hr>
                  <center><h4 class="text-uppercase mb-3"><b>Other Details</b></h4></center>
                  <div class="row mt-5">
                    <div class="col-md-3 mt-2">
                      <label for="facebook">Facebook</label>
                    </div>
                    <div class="col-md-6 mt-2">
                      <input type="text" class="form-control text-dark bg-light" id="facebook" placeholder="www.example.com" name="facebook">
                    </div>       
                  </div>
                  <div class="row mt-2">
                    <div class="col-md-3 mt-2">
                      <label for="twitter">Twitter</label>
                    </div>
                    <div class="col-md-6 mt-2">
                      <input type="text" class="form-control text-dark bg-light" id="twitter" placeholder="www.example.com" name="twitter">
                    </div>       
                  </div>
  
  
                  <div class="row mt-2">
                    <div class="col-md-3 mt-2">
                      <label for="website">Website</label>
                    </div>
                    <div class="col-md-6 mt-2">
                      <input type="text" class="form-control text-dark bg-light" id="website" placeholder="www.example.com" name="website">
                    </div>       
                  </div>
  
                  <div class="row mt-2">
                    <div class="col-md-3 mt-2">
                      <label for="cskype">Skype name/Number</label>
                    </div>
                    <div class="col-md-6 mt-2">
                      <input type="text" class="form-control text-dark bg-light" id="cskype" name="cskype">
                    </div>       
                  </div>
  
                  <div class="row mt-2">
                    <div class="col-md-3 mt-2">
                      <label for="c_desg">Designation</label>
                    </div>
                    <div class="col-md-6 mt-2">
                      <input type="text" class="form-control text-dark bg-light" id="c_desg" name="c_desg">
                    </div>       
                  </div>
  
                  <div class="row mt-2">
                    <div class="col-md-3 mt-2">
                      <label for="c_dpt">Department</label>
                    </div>
                    <div class="col-md-6 mt-2">
                      <input type="text" class="form-control text-dark bg-light" id="c_dpt" name="c_dpt">
                    </div>       
                  </div>
  
                  <div class="row mt-2">
                    <div class="col-md-3 mt-2">
                      <label for="c_gsttype" style="color:rgb(190, 88, 88);">GST Treatment *</label>
                    </div>
                    <div class="col-md-6 mt-2">
                      <select class="form-control text-dark bg-light" id="c_gsttype" name="c_gsttype" required>
                        <option value="value" selected>Select a Gst Treatment</option>
                        <option value="Registered Business-Regular Business that is registered under GST">Registered Business-Regular Business that is registered under GST</option>
                        <option value="Registered Business-Composition Business that is registered under the Composition scheme in GST">Registered Business-Composition Business that is registered under the Composition scheme in GST</option>
                        <option value="Unregistered Business-not Registered under GST">Unregistered Business-not Registered under GST</option>
                        <option value="Consumer- A customer who is a regular Consumer">Consumer- A customer who is a regular Consumer</option>
                        <option value="Overseas- Persons with who you do import or exports of supplies outside india">Overseas- Persons with who you do import or exports of supplies outside india</option>
                        <option value="Special Economic Zone">Special Economic Zone</option>
                      </select>
                    </div>       
                  </div>

                  <div class="row gstrow d-none" >
                    <div class="col-md-3 mt-2">
                      <label id="glbl" style="color:rgb(190, 88, 88);">GSTIN/UIN *</label>
                    </div>
                    <div class="col-md-6 mt-2">
                      <input type="text" class="form-control text-dark bg-light" id="c_gstin" name="c_gstin" 
                        placeholder="29APPCK7465F1Z1">
                      <label id="gst_label"></label>
                    </div>       
                  </div>
  
                 
  
                  <div class="row mt-2">
                    <div class="col-md-3 mt-2">
                      <label for="" style="color: rgb(190, 88, 88);">Place of Supply *</label>
                    </div>
                    <div class="col-md-6 mt-2">
                      <select class="form-control text-dark bg-light" id="placesupply" name="placesupply">
                        <option value="[AN]-Andaman and Nicobar Islads">[AN] Andaman and Nicobar Islads</option>
                      <option value="[AD]-Andhra Predhesh">[AD] Andhra Predhesh</option>
                      <option value="[AR]-Arunachal Predesh">[AR] Arunachal Predesh</option>
                      <option value="[AS]-Assam">[AS] Assam</option>
                      <option value="[BR]-Bihar">[BR] Bihar</option>
                      <option value="[CH]-Chandigarh">[CH] Chandigarh</option>
                      <option value="[CG]-Chhattisgarh">[CG] Chhattisgarh</option>
                      <option value="[DNH]-Dadra and Nagar Haveli">[DNH] Dadra and Nagar Haveli</option>
                      <option value="[DD]-Damn anad Diu">[DD] Damn anad Diu</option>
                      <option value="[DL]-Delhi">[DL] Delhi</option>
                      <option value="[GA]-Goa">[GA] Goa</option>
                      <option value="[GJ]-Gujarat">[GJ] Gujarat</option>
                      <option value="[HR]-Haryana">[HR] Haryana</option>
                      <option value="[HP]-Himachal Predesh">[HP] Himachal Predesh</option>
                      <option value="[JK]-Jammu and Kashmir">[JK] Jammu and Kashmir</option>
                      <option value="[JH]-Jharkhand">[JH] Jharkhand</option>
                      <option value="[KA]-Karnataka">[KA] Karnataka</option>
                      <option value="[KL]-Kerala">[KL] Kerala</option>
                      <option value="[LA]-Ladakh">[LA] Ladakh</option>
                      <option value="[LD]-Lakshadweep">[LD] Lakshadweep</option>
                      <option value="[MP]-Madhya Predesh">[MP] Madhya Predesh</option>
                      <option value="[MH]-Maharashtra">[MH] Maharashtra</option>
                      <option value="[MN]-Manipur">[MN] Manipur</option>
                      <option value="[ML]-Meghalaya">[ML] Meghalaya</option>
                      <option value="[MZ]-Mizoram">[MZ] Mizoram</option>
                      <option value="[NL]-Nagaland">[NL] Nagaland</option>
                      <option value="[OD]-Odisha">[OD] Odisha</option>
                      <option value="[PY]-Puducherry">[PY] Puducherry</option>
                      <option value="[PB]-Punjab">[PB] Punjab</option>
                      <option value="[RJ]-Rajasthan">[RJ] Rajasthan</option>
                      <option value="[SK]-Sikkim">[SK] Sikkim</option>
                      <option value="[TN]-Tamil Nadu">[TN] Tamil Nadu</option>
                      <option value="[TS]-Telangana">[TS] Telangana</option>
                      <option value="[TR]-Tripura">[TR] Tripura</option>
                      <option value="[UP]-Uttar Predesh">[UP] Uttar Predesh</option>
                      <option value="[UK]-Uttarakhand">[UK] Uttarakhand</option>
                      <option value="[WB]-West Bengal">[WB] West Bengal</option>
                      <option value="[OT]-Other Territory">[OT] Other Territory</option>
                      </select>
                    </div>       
                  </div>
  
                  <div class="row mt-2">
                    <div class="col-md-3 mt-2">
                      <label for="c_tax" style="color: rgb(190, 88, 88);">Tax Preference* </label>
                    </div>
                    <div class="col-md-6 mt-2">
                      <div class="d-flex">
                        <div class="radio_opt mx-5 mt-2">
                          <input type="radio" id="custtax1" name="radioCust1" value="Taxable" >
                          <label for="option1">Taxable</label>
                        </div>
                        <div class="radio_opt mx-4 mt-2">
                          <input type="radio" id="custtax2" name="radioCust1" value="Tax-exempt" >
                          <label for="option2">Tax-exempt</label>
                        </div>
                      </div>
                    </div>       
                  </div>
  
                  <div class="row mt-2">
                    <div class="col-md-3 mt-2">
                      <label for="c_curn">Currency </label>
                    </div>
                    <div class="col-md-3 mt-2">
                      <select class="form-control text-dark bg-light" id="c_curn" name="c_curn" required>
                        <option selected disabled value="">Choose..</option>
                        <option value="INR">INR</option>
                      </select>
                    </div>       
                  </div>
  
                  <div class="row mt-2">
                    <div class="col-md-3 mt-2">
                      <label for="c_open">Opening Balance</label>
                    </div>
                    <div class="col-md-6 mt-2">
                      <input type="text" class="form-control text-dark bg-light" id="c_open" name="c_open">
                    </div>       
                  </div>
  
                  <div class="row mt-2">
                    <div class="col-md-3 mt-2">
                      <label for="c_terms">Payment Terms</label>
                    </div>
                    <div class="col-md-6 mt-2">
                      <div class="d-flex">
                        <select class="form-control text-dark bg-light" id="c_terms" name="c_terms" required>
                          <!-- <option selected value="15">NET 15</option>
                          <option value="30">NET 30</option>
                          <option value="45">NET 45</option>
                          <option value="60">NET 60</option>
                          <option value="90">NET 90</option>
                          <option value="">Due end of the month</option>
                          <option value="recpt">Due on receipt</option> -->
                          {% for p in payments %}
                          <option value="{{p.Terms}} {{p.id}}">{{p.Terms}}</option>
                          {% endfor %}
                        </select>                
                        <a href="#" class="btn btn-outline-secondary py-2 my-1" data-target="#newpayment" data-toggle="modal">+</a>   
                      </div>
                    </div>       
                  </div>
                  
  
                  <hr>
  
                  <div class="row mt-2">
                    <div class="col-md-6 mt-5 text-center text-uppercase">
                      <h4 class="mb-0">Billing Address</h4>
                    </div>
                    <div class="col-md-6 mt-5">
                      <h4 class="mb-0 text-center text-uppercase">Shipping Address</h4>
                    </div>
                  </div>
                  <div class="row mt-2 m-0 p-0 mb-2">
                    <div class="col-md-9"> </div>
                    <div class="col-md-3 text-right  m-0 p-0">
                      <input type="checkbox" onclick="addressSame()" id="csokay" name="csokay">
                      <label for="csokay" style="color: #909091;">Same As Billing Address</label>
                    </div>
                  </div>
  
                  <div class="row mt-5">
                    <div class="col-md-1">
                      <label for="cstreet1">Address 1</label>
                    </div>
                    <div class="col-md-4">
                      <textarea class="form-control street text-dark bg-light" id="cstreet1" name="cstreet1"></textarea>
                    </div>
                    <div class="col-md-1"></div>
  
                    <div class="col-md-1">
                      <label for="csstreet1">Address 1</label>
                    </div>
                    <div class="col-md-4 ">
                      <textarea class="form-control street text-dark bg-light" id="csstreet1" name="csstreet1"></textarea>
                    </div>
                    <div class="col-md-1"></div>
  
                  </div>
                  <div class="row mt-5">
                    <div class="col-md-1">
                      <label for="cstreet2">Address 2</label>
                    </div>
                    <div class="col-md-4">
                      <textarea class="form-control street text-dark bg-light" id="cstreet2" name="cstreet2"></textarea>
                    </div>
                    <div class="col-md-1"></div>
  
                    <div class="col-md-1">
                      <label for="csstreet2">Address 2</label>
                    </div>
                    <div class="col-md-4 ">
                      <textarea class="form-control street text-dark bg-light" id="csstreet2" name="csstreet2"></textarea>
                    </div>
                    <div class="col-md-1"></div>
  
                  </div>
  
                  <div class="row mt-2">
                    <div class="col-md-1">
                      <label for="ccity">City</label>
                    </div>
                    <div class="col-md-4">
                      <input type="text" class="form-control text-dark bg-light" id="ccity" name="ccity" placeholder="City">  
                    </div>
                    <div class="col-md-1">
                    </div>
                    <div class="col-md-1">
                      <label for="cscity">City</label>
                    </div>
                    <div class="col-md-4">
                      <input type="text" class="form-control text-dark bg-light" id="cscity" name="cscity" placeholder="City">  
                    </div>
                    <div class="col-md-1">
                    </div>
                  </div>
  
                  <div class="row mt-2">
                    <div class="col-md-1">
                      <label for="cstate">State</label>
                    </div>
                    <div class="col-md-4">
                      <select type="text" class="form-control text-dark bg-light" id="cstate" name="cstate">
                        <option value="" selected>Choose</option>
                        <option value="None Of This">None Of This</option>
                        <option value="Andaman and Nicobar Islads">Andaman and Nicobar Islads</option>
                        <option value="Andhra Predhesh">Andhra Predhesh</option>
                        <option value="Arunachal Predesh">Arunachal Predesh</option>
                        <option value="Assam">Assam</option>
                        <option value="Bihar">Bihar</option>
                        <option value="Chandigarh">Chandigarh</option>
                        <option value="Chhattisgarh">Chhattisgarh</option>
                        <option value="Dadra and Nagar Haveli">Dadra and Nagar Haveli</option>
                        <option value="Damn anad Diu">Damn anad Diu</option>
                        <option value="Delhi">Delhi</option>
                        <option value="Goa">Goa</option>
                        <option value="Gujarat">Gujarat</option>
                        <option value="Haryana">Haryana</option>
                        <option value="Himachal Predesh">Himachal Predesh</option>
                        <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                        <option value="Jharkhand">Jharkhand</option>
                        <option value="Karnataka">Karnataka</option>
                        <option value="Kerala">Kerala</option>
                        <option value="Ladakh">Ladakh</option>
                        <option value="Lakshadweep">Lakshadweep</option>
                        <option value="Madhya Predesh">Madhya Predesh</option>
                        <option value="Maharashtra">Maharashtra</option>
                        <option value="Manipur">Manipur</option>
                        <option value="Meghalaya">Meghalaya</option>
                        <option value="Mizoram">Mizoram</option>
                        <option value="Nagaland">Nagaland</option>
                        <option value="Odisha">Odisha</option>
                        <option value="Puducherry">Puducherry</option>
                        <option value="Punjab">Punjab</option>
                        <option value="Rajasthan">Rajasthan</option>
                        <option value="Sikkim">Sikkim</option>
                        <option value="Tamil Nadu">Tamil Nadu</option>
                        <option value="Telangana">Telangana</option>
                        <option value="Tripura">Tripura</option>
                        <option value="Uttar Predesh">Uttar Predesh</option>
                        <option value="Uttarakhand">Uttarakhand</option>
                        <option value="West Bengal">West Bengal</option>
                        <option value="Other Territory">Other Territory</option>
                      </select>
                    </div>
                    <div class="col-md-1"></div>
    
                    <div class="col-md-1">
                      <label for="csstate">State</label>
                    </div>
                    <div class="col-md-4 ">
                      <select type="text" class="form-control text-dark bg-light" id="csstate" name="csstate">
                        <option value="" selected>Choose</option>
                        <option value="None Of This">None Of This</option>
                        <option value="Andaman and Nicobar Islads">Andaman and Nicobar Islads
                        </option>
                        <option value="Andhra Predhesh">Andhra Predhesh</option>
                        <option value="Arunachal Predesh">Arunachal Predesh</option>
                        <option value="Assam">Assam</option>
                        <option value="Bihar">Bihar</option>
                        <option value="Chandigarh">Chandigarh</option>
                        <option value="Chhattisgarh">Chhattisgarh</option>
                        <option value="Dadra and Nagar Haveli">Dadra and Nagar Haveli</option>
                        <option value="Damn anad Diu">Damn anad Diu</option>
                        <option value="Delhi">Delhi</option>
                        <option value="Goa">Goa</option>
                        <option value="Gujarat">Gujarat</option>
                        <option value="Haryana">Haryana</option>
                        <option value="Himachal Predesh">Himachal Predesh</option>
                        <option value="Jammu and Kashmir">Jammu and Kashmir</option>
                        <option value="Jharkhand">Jharkhand</option>
                        <option value="Karnataka">Karnataka</option>
                        <option value="Kerala">Kerala</option>
                        <option value="Ladakh">Ladakh</option>
                        <option value="Lakshadweep">Lakshadweep</option>
                        <option value="Madhya Predesh">Madhya Predesh</option>
                        <option value="Maharashtra">Maharashtra</option>
                        <option value="Manipur">Manipur</option>
                        <option value="Meghalaya">Meghalaya</option>
                        <option value="Mizoram">Mizoram</option>
                        <option value="Nagaland">Nagaland</option>
                        <option value="Odisha">Odisha</option>
                        <option value="Puducherry">Puducherry</option>
                        <option value="Punjab">Punjab</option>
                        <option value="Rajasthan">Rajasthan</option>
                        <option value="Sikkim">Sikkim</option>
                        <option value="Tamil Nadu">Tamil Nadu</option>
                        <option value="Telangana">Telangana</option>
                        <option value="Tripura">Tripura</option>
                        <option value="Uttar Predesh">Uttar Predesh</option>
                        <option value="Uttarakhand">Uttarakhand</option>
                        <option value="West Bengal">West Bengal</option>
                        <option value="Other Territory">Other Territory</option>
                      </select>
                    </div>
  
                    <div class="col-md-1"></div>
  
                  </div>
  
                  <div class="row mt-2">
                    <div class="col-md-1">
                      <label for="ccountry">Country</label>
                    </div>
                    <div class="col-md-4 ">
                      <input type="text" class="form-control text-dark bg-light" id="ccountry" name="ccountry" placeholder="Country">  
                    </div>
                    <div class="col-md-1"></div>
  
                    <div class="col-md-1">
                      <label for="cscountry">Country</label>
                    </div>
                    <div class="col-md-4">
                      <input type="text" class="form-control text-dark bg-light" id="cscountry"  name="cscountry" placeholder="Country">
                    </div>
                    <div class="col-md-1 "></div>
  
                  </div>
  
                  <div class="row mt-2">
  
                    <div class="col-md-1">
                      <label for="cpincode">Pincode</label>
                    </div>
                    <div class="col-md-4">
                      <input type="text" class="form-control text-dark bg-light" id="cpincode" name="cpincode" maxlength="6" placeholder="PIN Code"> 
                    </div>
                    <div class="col-md-1"></div>
  
                    <div class="col-md-1">
                      <label for="cspincode">Pincode</label>
                    </div>
                    <div class="col-md-4">
                      <input type="text" class="form-control text-dark bg-light" id="cspincode" name="cspincode" maxlength="6" placeholder="PIN Code">  
                    </div>
                    <div class="col-md-1"></div>
  
                  </div>
  
                  <div class="row mt-2">
  
                    <div class="col-md-1">
                      <label for="cphone">Phone</label>
                    </div>
                    <div class="col-md-4">
                      <input type="text" class="form-control text-dark bg-light" id="cphone" name="cphone" placeholder="Phone"> 
                    </div>
                    <div class="col-md-1"></div>
  
                    <div class="col-md-1">
                      <label for="csphone">Phone</label>
                    </div>
                    <div class="col-md-4">
                      <input type="text" class="form-control text-dark bg-light" id="csphone" name="csphone" placeholder="Phone">  
                    </div>
                    <div class="col-md-1"></div>
  
                  </div>
  
                  <div class="row mt-2">
  
                    <div class="col-md-1">
                      <label for="cfax">Fax</label>
                    </div>
                    <div class="col-md-4">
                      <input type="text" class="form-control text-dark bg-light" id="cfax" name="cfax" placeholder="FAX"> 
                    </div>
                    <div class="col-md-1"></div>
  
                    <div class="col-md-1">
                      <label for="csfax">Fax</label>
                    </div>
                    <div class="col-md-4">
                      <input type="text" class="form-control text-dark bg-light" id="csfax" name="csfax" placeholder="FAX">  
                    </div>
                    <div class="col-md-1"></div>
  
                  </div>
  
                  <div class="row mt-2">
                      <div class="col-md-6">
                        <input type="checkbox" value="" id="invalidCheck" name="invalidCheck" required>
                        <label for="invalidCheck" style="color: #909091;">Agree to terms and conditions</label>
                        <div class="invalid-feedback text-warning" >You must agree before submitting.</div>
                      </div>
                  </div>
                  <div class="row mt-5">
                    <div class="col-md-4"></div>
                    <div class="col-md-4">
                      <div class="d-flex">
                        <button class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3"
                        type="submit" data-dismiss="modal" id="customerSave">Submit
                        </button> 
  
                        <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-4" 
                          data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">Cancel</span>
                        </button>
                      </div>
                    </div>
                    <div class="col-md-4"></div>
                  </div>
                </form>
                    </div>
                </div>
            </div>
        </div>  
      </div>  
  
  
  
  <!-- ############################################################################################### -->
  
  <!--................................................... END CUSTOMER MODAL ...................................................... -->
  <!--.................................................... PAYMENT TERMS modal.................................................-->
<div class="modal fade" id="newpayment">
  <div class="modal-dialog modal-xl">
    <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
      <div class="modal-header " style="background: rgb(32, 35, 37);">
          <h3 class="m-3 text-uppercase">Add Payment Term</h3>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
          </button>
      </div>
      <div class="modal-body" style="background: rgb(32, 35, 37);">
        <div class="card p-3 m-3">
          <form action="" method="post" class="needs-validation" novalidate autocomplete="off" id="modalPayment">
            <div class="row mt-2">
              <div class="col-md-2 mt-2"></div>
              <div class="col-md-4 mt-2">
                <center><label for="termname" style="color: rgb(190, 88, 88);">Term Name *</label></center>
              </div>

              <div class="col-md-4 mt-2">
                <center><label for="termdays" style="color: rgb(190, 88, 88);">Number of Days *</label></center>
              </div>
              <div class="col-md-2 mt-2"></div>
            </div>


            <div class="row mt-2">
              <div class="col-md-2 mt-2"></div>

              <div class="col-md-4 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="term_name" name="term_name" required>      
              </div>

              <div class="col-md-4 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="term_days" name="term_days" required>
              </div>
              <div class="col-md-2 mt-2"></div>

            </div>
            
            <div class="row mt-5">
              <div class="col-md-4"></div>
              <div class="col-md-4">
                <div class="d-flex">
                  <button class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3"
                  type="submit" data-dismiss="modal" id="paySave">Save
                  </button> 
                  

                  <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-4" 
                    data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">Cancel</span>
                  </button>
                </div>
              </div>
              <div class="col-md-4"></div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>  
</div>  
<!-- ................................................  END PAYMENT TERMS MODAL..................................... -->

<!-- .................................................ITEM MODAL................................................. -->


<div class="modal fade" id="newitem">
  <div class="modal-dialog modal-xl">
    <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
      <div class="modal-header " style="background: rgb(32, 35, 37);">
        <h3 class="m-3 text-uppercase">New Item</h3>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" style="background: rgb(32, 35, 37);">
        <div class="card p-3 m-3">
          <form action="" method="post" class="needs-validation" novalidate autocomplete="off" id="modalItem">
            <div class="row mt-2">
              <div class="col-md-4 mr-0">
                <label class="col-form-label col-sm-2 p-0">Type <i class="fa fa-question-circle"></i></label>
              </div>
              <div class="col-md-5 ml-0 d-flex">
                <div class="radio_opt mx-5 ">
                  <input type="radio" id="item_type1" name="radioOption" value="Goods" >
                  <label for="option1">Goods</label>
                </div>
                <div class="radio_opt mx-5 ">
                  <input type="radio" id="item_type2" name="radioOption" value="Services" >
                  <label for="option2">Services</label>
                </div>
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-3">
                <label for="name" style="color: rgb(190, 88, 88);">Name *</label>
              </div>
              <div class="col-md-6">
                <input type="text" class="form-control text-dark bg-light" id="item_name" name="item_name" required>
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-3">
                <label for="" style="color: rgb(190, 88, 88);">HSN*</label>
              </div>
              <div class="col-md-6">
                <input type="text" class="form-control text-dark bg-light" id="hsn_no" name="hsn_no" required>
                <label for="" id="hsn_label"></label>
              </div>
            </div>
            <div class="row mt-2">
              <div class="col-md-3 ">
                <label for="units">Unit</label>
              </div>
              <div class="col-md-6">
                <div class="d-flex">
                  <select class="form-control text-dark bg-light" id="item_units" name="item_units" required>
                    <option value="">Select Unit</option>
                    {% for u in units %}
                    <option value="{{u.id}}">{{u.unit}}</option>
                    {% endfor %}
                  </select>                
                  <a href="#" class="btn btn-outline-secondary py-2 my-1" data-target="#newunit" data-toggle="modal">+</a>  
                </div>
              </div>
            </div>

            <div class="row mt-2">
              <div class="col-md-4 ">
                <label for="c_tax" style="color: rgb(190, 88, 88);">Tax Preference * </label>
              </div>
              <div class="col-md-5">
                <div class="d-flex">
                  <div class="radio_opt mx-5 mt-2">
                    <input type="radio" id="item-tax1" name="radioOption1" value="Taxable" >
                    <label for="option1">Taxable</label>
                  </div>
                  <div class="radio_opt mx-4 mt-2">
                    <input type="radio" id="item-tax2" name="radioOption1" value="Tax-exempt" >
                    <label for="option2">Tax-exempt</label>
                  </div>
                </div>
              </div>       
            </div>

            <div class="row mt-2 mb-4 d-none inter-intra" >
              <div class="col-md-3">
                <label for="intra">Intra-State TAX</label>
              </div>
              <div class="col-md-3">
                <select name="intra" class="form-control text-dark bg-light" id="intra">
                  <option value="">Select GST</option>

                  <option value="GST0[0%]">GST0[0%]</option>
                  <option value="GST5[5%]">GST5[5%]</option>
                  <option value="GST12[12%]">GST12[12%]</option>
                  <option value="GST18[18%]">GST18[18%]</option>
                  <option value="GST28[28%]">GST28[28%]</option>
                </select>             
              </div>

              
              <div class="col-md-2">
                <label for="inter">Inter-State TAX</label>
              </div>
              <div class="col-md-3">
                <select name="inter" class="form-control text-dark bg-light" id="inter">
                  <option value="">Select IGST</option>

                  <option value="IGST0[0%]">IGST0[0%]</option>
                  <option value="IGST5[5%]">IGST5[5%]</option>
                  <option value="IGST12[12%]">IGST12[12%]</option>
                  <option value="IGST18[18%]">IGST18[18%]]</option>
                  <option value="IGST28[28%]">IGST28[28%]</option>
                </select>               
              </div>
              <div class="col-md-1"></div>

            </div>
            
            <hr>

            <div class="row mt-5 text-center">
              <div class="col-md-6 d-flex text-center">
                <input  type="checkbox" name="selling" checked class="mx-2 my-0">
                <h6 class="m-0">Selling Information</h6>
              </div>
              <div class="col-md-6 d-flex text-center">
                <input  type="checkbox" name="purchase" checked class="mx-2 my-0">
                <h6 class="m-0">Purchase Information</h6>
              </div>
            </div>
            
            <div class="row mt-4">
              <div class="col-md-2">
                <label for="sell_price">Selling Price *</label>
              </div>
              <div class="col-md-4">
                <div class="input-group mb-2">
                  <div class="input-group-prepend">
                    <div class="input-group-text">INR</div>
                  </div>
                  <input required type="text" class="form-control text-dark bg-light" name="sell_price" id="sell_price">
                </div>                  
              </div>

              <div class="col-md-2">
                <label for="cost_price">Cost Price *</label>
              </div>
              <div class="col-md-4 ">
                <div class="input-group mb-2">
                  <div class="input-group-prepend">
                    <div class="input-group-text">INR</div>
                  </div>
                  <input required type="text" class="form-control text-dark bg-light" name="cost_price" id="cost_price">
                </div>
              </div>
            </div>

            <div class="row mt-2">
              <div class="col-md-2">
                <label for="vcity">Account</label>
              </div>
              <div class="col-md-4">
                <select name="sell_acc" id="sell_acc" class="form-control text-dark bg-light">
                  <option value="">Select Account</option>
   
                  
                    {% for s in sales %}
                        <option value="{{s.id}}">{{ s.Account_name }}</option>
                  {% endfor %}
                </select> 
              </div>
              <div class="col-md-2">
                <label for="cost_acc">Account</label>
              </div>
              <div class="col-md-4">
                <select name="cost_acc" class="form-control text-dark bg-light" id="cost_acc">
                  <option value="">Select Account</option>


                    {% for p in purchase %}
                        <option value="{{p.id}}">{{ p.Account_name }}</option>
                  {% endfor %}

                </select> 
              </div>
            </div>

            <div class="row mt-2">
              <div class="col-md-2">
                <label for="sell_desc">Description</label>
              </div>
              <div class="col-md-4">
                <input  type="text" name="sell_desc" class="form-control text-dark bg-light"  id="sell_desc">
              </div>

              <div class="col-md-2">
                <label for="cost_desc">Description</label>
              </div>
              <div class="col-md-4 ">
                <input  type="text" name="cost_desc" class="form-control text-dark bg-light"  id="cost_desc">
              </div>

            </div>

            <div class="row mt-3">
                <div class="col-md-6">
                  <input type="checkbox" value="" id="invalidCheck" name="invalidCheck" required>
                  <label for="invalidCheck" style="color: #909091;">Agree to terms and conditions</label>
                  <div class="invalid-feedback text-warning" >You must agree before submitting.</div>
                </div>
            </div>
            <div class="row ">
              <div class="col-md-5"></div>
              <div class="col-md-3">
                <div class="d-flex">
                  <button class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3"
                      type="submit" data-dismiss="modal" id="itemSave">Submit
                  </button> 

                  <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-4" 
                    data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">Cancel</span>
                  </button>
                </div>
              </div>
              <div class="col-md-4"></div>
            </div>
          </form>
        </div>
      </div>
      </div>
  </div>  
</div>  


          
          
          
          <!-- ....................................................  END ITEM MODAL................................. -->

<!-- ............................................unit modal............................................ -->

 <div class="modal fade" id="newunit">
  <div class="modal-dialog modal-xl">
    <div class="modal-content" style="background: rgb(32, 35, 37);border-radius: 20px;">
      <div class="modal-header " style="background: rgb(32, 35, 37);">
          <h3 class="m-3 text-uppercase">Add Unit</h3>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
          </button>
      </div>
      <div class="modal-body" style="background: rgb(32, 35, 37);">
        <div class="card p-3 m-3">
          <form action="" method="post" class="needs-validation" novalidate autocomplete="off" id="modalUnit">
            <div class="row mt-2">
              <div class="col-md-3 mt-2"></div>
              <div class="col-md-1 mt-2">
                <label for="unit" style="color: rgb(190, 88, 88);">Unit</label>
              </div>

              <div class="col-md-4 mt-2">
                <input type="text" class="form-control text-dark bg-light" id="unit" name="unit" required>
              </div>
              <div class="col-md-4 mt-2"></div>
            </div>
            
            <div class="row mt-5">
              <div class="col-md-4"></div>
              <div class="col-md-4">
                <div class="d-flex">
                  <button class="btn save_btn rounded-pill text-grey w-50 my-4 mx-3"
                  type="submit" data-dismiss="modal" id="unitSave">Save
                  </button> 
                  

                  <button type="button" class="close btn save_btn rounded-pill text-grey w-50 my-4" 
                    data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">Cancel</span>
                  </button>
                </div>
              </div>
              <div class="col-md-4"></div>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>  
</div>  


<!-- ............................................  END UNIT MODAL..................................................... -->





        </div>

    </div>



</section>

<script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
    integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
    crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.6.4.js" integrity="sha256-a9jBBRygX1Bh5lt8GZjXDzyOB+bWve9EiO7tROUtj/E="
    crossorigin="anonymous"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    
    <script>
      function place_of_supply()
      {
        var place_dropdown=document.getElementById("cus_place1").value;
        document.getElementById("cus_place_second").value=place_dropdown;
        var place=document.getElementById("cus_place_second").value;
        var ste=document.getElementById("state1").value;
        var y=ste.toLowerCase();
        const parts = place.split("-");   
        var extractedWord = parts[1];  
        var extractedWord1= extractedWord.trim();
        var x=extractedWord1.toLowerCase();
        var place=document.getElementById("cus_place").value=x;    
        if ( x == y )
          {
             document.getElementById("item_table").style.display="block"
             document.getElementById("item_tablee").style.display="none"
             document.getElementById("label_tab1").style.display="block"
             document.getElementById("label_tab2").style.display="none"
             document.getElementById("add-row").style.display="block"
             document.getElementById("add-roww").style.display="none"
          
          }
          else
          {
             document.getElementById("item_table").style.display="none"
             document.getElementById("item_tablee").style.display="block"
             document.getElementById("label_tab1").style.display="none"
             document.getElementById("label_tab2").style.display="block"
             document.getElementById("add-row").style.display="none"
             document.getElementById("add-roww").style.display="block"
          }
      }
    </script>



    <script>

      function addressSame(){
          var chkbtn1 = document.getElementById('vokay');
          var chkbtn2 = document.getElementById('csokay');
      
      
          if (chkbtn2.checked == true) {
            document.getElementById('csstreet1').value = document.getElementById('cstreet1').value;
            document.getElementById('csstreet2').value = document.getElementById('cstreet2').value;
            document.getElementById('cscity').value = document.getElementById('ccity').value;
            document.getElementById('cspincode').value = document.getElementById('cpincode').value;
            document.getElementById('cscountry').value = document.getElementById('ccountry').value;
            document.getElementById('csstate').value = document.getElementById('cstate').value;
            document.getElementById('csphone').value = document.getElementById('cphone').value;
            document.getElementById('csfax').value = document.getElementById('cfax').value;
          } 
          else {
            document.getElementById('csstreet1').value = '';
            document.getElementById('csstreet2').value = '';
            document.getElementById('cscity').value = '';
            document.getElementById('csstate').value = '';
            document.getElementById('cspincode').value = '';
            document.getElementById('cscountry').value = '';
            document.getElementById('csphone').value = '';
            document.getElementById('csfax').value = '';
          }
        }
      
      
      
      </script>

      <script>

$(document).ready(function() {
    $("#c_gsttype").change(function() {
      var x=$('#c_gsttype').val();
      // console.log(x)
      if(x=="Unregistered Business-not Registered under GST") 
      {
        $(".gstrow").addClass('d-none');

      }
      else if(x == 'Overseas- Persons with who you do import or exports of supplies outside india'){
        $(".gstrow").addClass('d-none');
      }
      else 
      {
        $(".gstrow").removeClass('d-none');
        $(".gstrow").addClass('d-flex');
      }
    
    });
  });


    $(document).ready(function() {
    $("#c_gstin").change(function() {

        var x=$("#c_gstin").val();
        var gst_label=document.getElementById("gst_label")
        var expr=/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/;
        if (!expr.test(x)) {
            gst_label.style.color="red";
            gst_label.innerHTML = "Invalid GST Number.";
        }
        else{
            gst_label.style.color="green";
            gst_label.innerHTML = "valid GST Number.";

        }
      });
    });


    $(document).ready(function(){
      $("#hsn_no").change(function(){
        var x=$("#hsn_no").val();
        var hsn_label=document.getElementById("hsn_label")
        var expr=/^[0-9]{6}$/;
        if ( !expr.test(x)){
          hsn_label.style.color="red";
            hsn_label.innerHTML = "Invalid HSN Number.";
        }
        else{
            hsn_label.style.color="green";
            hsn_label.innerHTML = "valid HSN Number.";

        }


      })

    });





      </script>



<script>



 //---------modal customer-----


 $(document).ready(function() {
    $("#cfname, #clname").change(function() {
      $("#cdisplayname").text($("#ctitle").val() +" " + $("#cfname").val() + " " + $("#clname").val());
    });
  });

// ######################################################################

$(document).on("click","#customerSave",function(){

if ($('input[name="radioCust"]:checked').val() == 'Business'){

  custType = $('#business').val();
}
else{
  custType = $('#individual').val();
}
  
if ($('input[name="radioCust1"]:checked').val() == 'Taxable'){
  cust_tax = $('#custtax1').val();
}
else{
    cust_tax = $('#custtax2').val();
}
$.ajax({
  
  type : 'POST',
  url:"{% url 'new_estimate_customer' %}",

  data:{
      customer_type : custType,
      display_name : $('#cdisplayname').text(),
      company_name : $('#ccompany').val(),
      email : $("#cemail").val(),
      work_mobile :$("#cw_mobile").val(),
      pers_mobile :$("#cp_mobile").val(),
      facebook :$("#facebook").val(),
      twitter :$("#twitter").val(),
      website :$("#website").val(),
      skype :$("#cskype").val(),
      desg :$("#c_desg").val(),
      dpt :$("#c_dpt").val(),
      gsttype :$("#c_gsttype").val(),
      gstno:$("#c_gstin").val(),      
      placeofsupply :$("#placesupply").val(),
      tax_preference :cust_tax,
      currency : $("#c_curn").val(),
      openingbalance : $("#c_open").val(),
      paymentterms : $("#c_terms").val(),
      street1 : $("#cstreet1").val(),
      street2 : $("#cstreet2").val(),
      city : $("#ccity").val(),
      state : $("#cstate").val(),
      pincode : $("#cpincode").val(),
      fax : $("#cfax").val(),
      phone : $("#cphone").val(),
      country : $("ccountry").val(),
      csrfmiddlewaretoken: '{{ csrf_token }}'
      
    },
  
    success: function(response) {
      document.getElementById("modalCustomer").reset();
      reloadCustomer();
    },
});        
});

function reloadCustomer() {

$.ajax({
  url: "{% url 'customer_dropdown' %}",
  type: "GET",
  dataType: "json",
  data: $(this).serialize(),
  csrfmiddlewaretoken: '{{ csrf_token }}',

  success: function(data) {
    var dropdown = $('#customer_sel');
    dropdown.empty();
    $.each(data, function(key, value) {
        // dropdown.append($('<option></option>').attr('value', key).text(value[1]).val(value[0] + ' ' + value[1]));
        dropdown.append($('<option></option>').attr('value', key).text(value[1]).val(key));
    });
  },
  error: function(xhr, status, error) {
  console.error(xhr.responseText);
  }
});
}


$(document).ready(function() {
    $('#customer_sel').change(function() {

        var name = $("#customer_sel").val();
        var na = name.split(' ')[0];
        var table = document.getElementById("item_table");
        $.ajax({

            url: "{% url 'get_customerdet' %}", 

            data: { 
                    id : na,
                    csrfmiddlewaretoken: '{{ csrf_token }}' 
                },

            type : 'POST',

            success: function(data) {

              // $("#cemail_row").removeClass('d-none');
              // $("#cemail_row").addClass('d-flex');
              
              
              $('#customer_mail').val(' '+ data.customer_email);
              $('#samp').val(data.cust_place_supply);
              $('#customer_id').val(data.cust_id);
              $('#cus_place1').val(data.cust_place_supply);
              $('#cus_place_second').val(data.cust_place_supply);
              $('#customer_gst_treat').val(data.cust_gst_treat);
              $('#customer_gstno').val(data.cust_gstno);
              var GSTNO=document.getElementById('customer_gstno').value;
              var expr=/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/;

              if (!expr.test(GSTNO)) 
              {
                $("#cgstno_row").removeClass('d-flex');
                $("#cgstno_row").addClass('d-none');
             }
           else{
                $("#cgstno_row").removeClass('d-none');
                $("#cgstno_row").addClass('d-flex');
              }
              var plc=document.getElementById("samp").value
              var ste=document.getElementById("state1").value
              var y=ste.toLowerCase();  
              var inputstring=plc;
              const parts = inputstring.split("-");   
              var extractedWord = parts[1];  
              var extractedWord1= extractedWord.trim();
              var x=extractedWord1.toLowerCase();  
              $('#cus_place').val(x);
              $('#state').val(y);

                                if ( x == y )
                                {
                                   document.getElementById("item_table").style.display="block"
                                   document.getElementById("item_tablee").style.display="none"
                                   document.getElementById("label_tab1").style.display="block"
                                   document.getElementById("label_tab2").style.display="none"
                                   document.getElementById("add-row").style.display="block"
                                   document.getElementById("add-roww").style.display="none"
                                  


                                    
                        
                                }
                                else
                                {
                                   document.getElementById("item_table").style.display="none"
                                   document.getElementById("item_tablee").style.display="block"
                                   document.getElementById("label_tab1").style.display="none"
                                   document.getElementById("label_tab2").style.display="block"
                                   document.getElementById("add-row").style.display="none"
                                   document.getElementById("add-roww").style.display="block"
                                    
                                    
                                }
                    
              
            }
           
        });
    });
});

// ......................payment term modal

$(document).on("click","#paySave",function(){
  $.ajax({
    
    type : 'POST',
    url:"{% url 'recurbills_pay' %}",

    data:{
        name : $("#term_name").val(),
        days : $("#term_days").val(),
        
        csrfmiddlewaretoken: '{{ csrf_token }}'
        
      },
    
      success: function(response) {
        document.getElementById("modalPayment").reset();
        reloadPayment();
      },
  });        
});

function reloadPayment() {

  $.ajax({
    url: "{% url 'pay_dropdown' %}",
    type: "GET",
    dataType: "json",
    data: $(this).serialize(),
    csrfmiddlewaretoken: '{{ csrf_token }}',

    success: function(data) {
      var dropdown = $('#c_terms');
      dropdown.empty();
      // dropdown.append(`<option selected value="15">NET 15</option>
      //                     <option value="30">NET 30</option>
      //                     <option value="45">NET 45</option>
      //                     <option value="60">NET 60</option>
      //                     <option value="90">NET 90</option>
      //                     <option value="">Due end of the month</option>
      //                     <option value="recpt">Due on receipt</option>`);
      // var drpv = $('#inv_term');
      // drpv.empty();
      // drpv.append(`<option selected value="15">NET 15</option>
      //                   <option value="30">NET 30</option>
      //                   <option value="45">NET 45</option>
      //                   <option value="60">NET 60</option>
      //                   <option value="90">NET 90</option>
      //                   <option value="">Due end of the month</option>
      //                   <option value="recpt">Due on receipt</option>`);
      $.each(data, function(key, value) {
          dropdown.append($('<option></option>').attr('value', key).text(value[0]).val(value[1]));
       });
    },
    error: function(xhr, status, error) {
    console.error(xhr.responseText);
    }
  });
}



   // item modal

   $(document).ready(function() {

$("#item-tax1").click(function() {
  $(".inter-intra").removeClass('d-none');
  $(".inter-intra").addClass('d-flex');
});

$("#item-tax2").click(function() {

  $(".inter-intra").removeClass('d-flex');
  $(".inter-intra").addClass("d-none");
});
});


$(document).on("click","#itemSave",function(){

if ($('input[name="radioOption"]:checked').val() == 'Goods'){

    itemtype = $('#item_type1').val();
  }
else{
  itemtype = $('#item_type2').val();
}

if ($('input[name="radioOption1"]:checked').val() == 'Taxable'){
    inter_st = $('#inter').val();
    intra_st = $('#intra').val();
  }
else{
  inter_st = 0;
  intra_st = 0;
}

$.ajax({
  
  type : 'POST',
  url:"{% url 'new_estimate_item' %}",
  
  data:{
      type : itemtype,
      name : $("#item_name").val(),
      hsn:$("#hsn_no").val(),
      unit : $("#item_units").val(),
      inter : inter_st,
      intra : intra_st,
      sell_price : $("#sell_price").val(),
      cost_price : $("#cost_price").val(),
      sell_acc : $("#sell_acc").val(),
      cost_acc : $("#cost_acc").val(),
      sell_desc : $("#sell_desc").val(),
      cost_desc : $("#cost_desc").val(),
      
      csrfmiddlewaretoken: '{{ csrf_token }}'
      
    },
  
    success: function(response) {
      // console.log(response)
      document.getElementById("modalItem").reset();
      reloadItem();
    },
});        
});



function reloadItem() {
  $.ajax({
    url: "{% url 'item_dropdown' %}",
    type: "GET",
    dataType: "json",
    data: $(this).serialize(),
    csrfmiddlewaretoken: '{{ csrf_token }}',

    success: function(data) {
      var dropdown = $('.itm');
      var dropdown1 = $('.itmm');
      dropdown.empty();
      dropdown1.empty();
      $.each(data, function(key, value) {
        dropdown.append($('<option class="text-dark"></option>').attr('value', key).text(value[0]).val(value[1]));
        dropdown1.append($('<option class="text-dark"></option>').attr('value', key).text(value[0]).val(value[1]));
      });

    },
    error: function(xhr, status, error) {
    console.error(xhr.responseText);
    }
  });
}

// unit modal


$(document).on("click","#unitSave",function(){
  $.ajax({
    type : 'POST',
    url:"{% url 'recurbills_unit' %}",
    data:{
        unit : $("#unit").val(),                
        csrfmiddlewaretoken: '{{ csrf_token }}'        
      },    
      success: function(response) {
        document.getElementById("modalUnit").reset();
        reloadUnit();
      },
  });        
});


function reloadUnit() {

  $.ajax({
    url: "{% url 'unit_dropdown' %}",
    type: "GET",
    dataType: "json",
    data: $(this).serialize(),
    csrfmiddlewaretoken: '{{ csrf_token }}',

    success: function(data) {
      var dropdown = $('#item_units');
      dropdown.empty();

      $.each(data, function(key, value) {
          dropdown.append($('<option></option>').attr('value', key).text(value[0]).val(value[1]));
      });
    },
    error: function(xhr, status, error) {
    console.error(xhr.responseText);
    }
  });
}









    // set todays date on estimate date field
    // var today = new Date().toISOString().substr(0, 10);
    // document.getElementById("estimate_date").value = today;
    // document.getElementById("expiry_date").value = today;

    //...........................................   Add new row   TABLE 1  ......................
    $(document).ready(function () {
        $('#add-row').click(function () {
            var table = document.getElementById("item_table");
            var RowCount = table.rows.length;
            console.log(RowCount);
            var newRow = $(`
            <tr id='row${RowCount}'>
                <td>
                    <div class='form-group'>
                        <select
                            class='form-control bg-transparent text-light border-0 item_select' name='item[]'
                            id='item${RowCount}'>
                            <option class='text-dark'>Select Items</option>
                            {% for i in items %}
                            <option class="text-dark" value="{{i.Name}}">{{i.Name}}</option>
                            {% endfor %}
                        </select></div>
                </td>
                <td class='text-right '><input type='number' id='hsn${RowCount}'
                        class='form_control bg-transparent border-0 text-light text-right hsn' name='hsn[]' style="width:85%" value='0.00' readonly>
                </td>
                <td class='text-right'><input type='number' id='qty${RowCount}'
                        class='form-control bg-transparent border-0 text-light text-right qty' name='quantity[]' value='0.00' >
                </td>
                <td class='text-right'><input type='number' id='rate${RowCount}'
                        class='form-control bg-transparent border-0 text-light text-right rate' name='rate[]' value='0.00'
                        ></td>
                <td class='text-right'><input type='number' id='discount${RowCount}'
                        class='form-control bg-transparent border-0 text-light text-right discount' name='discount[]' value='0.00'>
                </td>
                <td class='text-right'> <select name='tax[]' id='tax${RowCount}'
                        class="form-control bg-transparent text-light text-right border-0 tax">
                        <option value=0>0% GST</option>
                                    <option value=3 class="text-dark">3% GST</option>
                                    <option value=5 class="text-dark">5% GST</option>
                                    <option value=12 class="text-dark">12% GST</option>
                                    <option value=18 class="text-dark">18% GST</option>
                                    <option value=28 class="text-dark">28% GST</option> 
                    </select></td>
                <td style="display: none;">
                    <input type="text" name='taxamount1' id="taxamount${RowCount}" class="form-control taxamount" />
                            </td>
                <td class='text-right'><input type='number' id='amount${RowCount}'
                        class='form-control bg-transparent border-0 text-light text-right amount' name='amount[]' value='0.00' readonly></td>
                <td class='text-center'><button type='button' id='del_btn${RowCount}'
                        class='btn btn-transparent text-danger btn-sm btn-outline-danger rounded-circle delete-row'
                        style='width:30px'><i class='fa fa-times'></i></button>
                        <button type='button' class='btn btn-transparent text-primary btn-sm btn-outline-primary rounded-circle clone-row' data-row=1 style='width:30px'><i class="fa fa-clone"></i>
                                    </button>
                        </td>
            </tr>`);
            $('#item_table').append(newRow);
        });

        $('#item_table').on('click', '.delete-row', function () {
            $(this).closest('tr').remove();
            calc();
        });

    });


   //...........................................   Add new row   TABLE 2  ......................
   $(document).ready(function () {
        $('#add-roww').click(function () {
            var tablee = document.getElementById("item_tablee");
            var RowCountt = tablee.rows.length;
            console.log(RowCountt);
            var newRoww = $(`
            <tr id='row${RowCountt}' >
                <td>
                    <div class='form-group'>
                        <select
                            class='form-control bg-transparent text-light border-0 item_selectt' name='itemm[]'
                            id='itemm${RowCountt}'>
                            <option class='text-dark'>Select Items</option>
                            {% for i in items %}
                            <option class="text-dark" value="{{i.Name}}">{{i.Name}}</option>
                            {% endfor %}
                        </select></div>
                </td>
                <td class='text-right '><input type='number' id='hsnn${RowCountt}'
                        class='form_control bg-transparent border-0 text-light text-right hsnn' name='hsnn[]' style="width:85%" value='0.00' readonly>
                </td>
                <td class='text-right'><input type='number' id='qtyy${RowCountt}'
                        class='form-control bg-transparent border-0 text-light text-right qtyy' name='quantityy[]' value='0.00' >
                </td>
                <td class='text-right'><input type='number' id='ratee${RowCountt}'
                        class='form-control bg-transparent border-0 text-light text-right ratee' name='ratee[]' value='0.00'
                        ></td>
                <td class='text-right'><input type='number' id='discountt${RowCountt}'
                        class='form-control bg-transparent border-0 text-light text-right discountt' name='discountt[]' value='0.00'>
                </td>
                <td class='text-right'> <select name='taxx[]' id='taxx${RowCountt}'
                        class="form-control bg-transparent text-light text-right border-0 taxx">
                        <option value=0>0% IGST</option>
                                    <option value=3 class="text-dark">3% IGST</option>
                                    <option value=5 class="text-dark">5% IGST</option>
                                    <option value=12 class="text-dark">12% IGST</option>
                                    <option value=18 class="text-dark">18% IGST</option>
                                    <option value=28 class="text-dark">28% IGST</option> 
                    </select></td>
                <td style="display: none;">
                    <input type="text" name='taxamountt1' id="taxamountt${RowCountt}" class="form-control taxamountt" />
                            </td>
                <td class='text-right'><input type='number' id='amountt${RowCountt}'
                        class='form-control bg-transparent border-0 text-light text-right amountt' name='amountt[]' value='0.00' readonly></td>
                <td class='text-center'><button type='button' id='del_btnn${RowCountt}'
                        class='btn btn-transparent text-danger btn-sm btn-outline-danger rounded-circle delete-roww'
                        style='width:30px'><i class='fa fa-times'></i></button>
                        <button type='button' class='btn btn-transparent text-primary btn-sm btn-outline-primary rounded-circle clone-roww' data-row=1 style='width:30px'><i class="fa fa-clone"></i>
                    </button>
                        </td>
            </tr>`);
            $('#item_tablee').append(newRoww);
        });

        $('#item_tablee').on('click', '.delete-roww', function () {
            $(this).closest('tr').remove();
            calc();
        });

    });






// .................... ..............          Event handler for clone button..... TABLE 1.......................
var rowCount = 1;
$('#item_table').on('click', '.clone-row', function () {
  var row = $(this).closest('tr');
  var clonedRow = row.clone(); // Clone the current row
  var newRowId = 'row' + rowCount; // Generate a new ID for the cloned row
  clonedRow.attr('id', newRowId); // Set the new ID for the cloned row

  // Clone the options for tax, account, and item
  var currentItem = row.find('.item_select').val();
  clonedRow.find('.item_select').val(currentItem);
  
  var currentTax = row.find('.tax').val();
  clonedRow.find('.tax').val(currentTax);

  rowCount++; // Increment row counter

  $('#item_table tbody').append(clonedRow);
  var row = $(this).closest('tr');
  calc();
  calc_total();
     
});

// .................... ..............          Event handler for clone button..... TABLE 2.......................
var rowCountt = 1;
$('#item_tablee').on('click', '.clone-roww', function () {
  var roww = $(this).closest('tr');
  var clonedRoww = roww.clone(); // Clone the current row
  var newRowIdd = 'row' + rowCountt; // Generate a new ID for the cloned row
  clonedRoww.attr('id', newRowIdd); // Set the new ID for the cloned row

  // Clone the options for tax, account, and item
  var currentItemm = roww.find('.item_selectt').val();
  clonedRoww.find('.item_selectt').val(currentItemm);
  
  var currentTaxx = roww.find('.taxx').val();
  clonedRoww.find('.taxx').val(currentTaxx);

  rowCountt++; // Increment row counter

  $('#item_tablee tbody').append(clonedRoww);
  var roww = $(this).closest('tr');
  calc();
  calc_total();
     
});


    // Calculate total
    $(document).ready(function () {
        $('#shipping, #adjustment').on('keyup', function () {
            var shipping_charge = parseFloat($('#shipping').val() || 0);
            var adjustment_charge = parseFloat($('#adjustment').val() || 0);
            var subtotal = parseFloat($('#subtotal').val() || 0);
            var total_tax = parseFloat($('#total_taxamount').val() || 0);
            var total = subtotal + total_tax + shipping_charge + adjustment_charge;

            $('#shipping_charge').val(shipping_charge.toFixed(2));
            $('#adjustment_charge').val(adjustment_charge.toFixed(2));
            $('#total').val(total.toFixed(2));
        });
    });

</script>


<script>
  $(document).ready(function () {
      var roinc = 0
      console.log("ajax");
      // var place = document.getElementById('pos').value;
      $(document).on('click', '#item1', function () {
          select = $('#item1').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn
                  document.getElementById('rate1').value = data
                  document.getElementById('hsn1').value = data4
                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst1').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst1').value = data1
                  }
                  document.getElementById('tigst1').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst1').value = data2
              }
          });
      });
      // console.log('pos:'+place_of_supply);
      $(document).on('click', '#item2', function () {
          select = $('#item2').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('rate2').value = data

                  document.getElementById('hsn2').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst2').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst2').value = data1
                  }
                  document.getElementById('tigst2').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst2').value = data2

              }
          });

      });

      $(document).on('click', '#item3', function () {
          select = $('#item3').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('rate3').value = data

                  document.getElementById('hsn3').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst3').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst3').value = data1
                  }
                  document.getElementById('tigst3').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst3').value = data2

              }
          });

      });

      $(document).on('click', '#item4', function () {
          select = $('#item4').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('rate4').value = data

                  document.getElementById('hsn4').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst4').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst4').value = data1
                  }
                  document.getElementById('tigst4').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst4').value = data2

              }
          });

      });

      $(document).on('click', '#item5', function () {
          select = $('#item5').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('rate5').value = data

                  document.getElementById('hsn5').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst5').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst5').value = data1
                  }
                  document.getElementById('tigst5').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst5').value = data2

              }
          });

      });

      $(document).on('click', '#item6', function () {
          select = $('#item6').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('rate6').value = data

                  document.getElementById('hsn6').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst6').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst6').value = data1
                  }
                  document.getElementById('tigst6').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst6').value = data2

              }
          });

      });

      $(document).on('click', '#item7', function () {
          select = $('#item7').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('rate7').value = data

                  document.getElementById('hsn7').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst7').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst7').value = data1
                  }
                  document.getElementById('tigst7').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst7').value = data2

              }
          });

      });                 

      $(document).on('click', '#item8', function () {
          select = $('#item8').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('rate8').value = data

                  document.getElementById('hsn8').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst8').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst8').value = data1
                  }
                  document.getElementById('tigst8').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst8').value = data2

              }
          });

      });

      $(document).on('click', '#item9', function () {
          select = $('#item9').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('rate9').value = data

                  document.getElementById('hsn9').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst9').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst9').value = data1
                  }
                  document.getElementById('tigst9').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst9').value = data2

              }
          });

      });

      $(document).on('click', '#item10', function () {
          select = $('#item10').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('rate10').value = data
                  document.getElementById('hsn10').value = data4


                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst10').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst10').value = data1
                  }
                  document.getElementById('tigst10').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst10').value = data2

              }
          });

      });

      $(document).on('click', '#item11', function () {
          select = $('#item11').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('rate11').value = data
                  document.getElementById('hsn11').value = data4


                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst11').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst11').value = data1
                  }
                  document.getElementById('tigst11').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst11').value = data2

              }
          });

      });

      $(document).on('click', '#item12', function () {
          select = $('#item12').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('rate12').value = data
                  document.getElementById('hsn12').value = data4


                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst12').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst12').value = data1
                  }
                  document.getElementById('tigst12').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst12').value = data2

              }
          });

      });

      $(document).on('click', '#item13', function () {
          select = $('#item13').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('rate13').value = data
                  document.getElementById('hsn13').value = data4


                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst13').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst13').value = data1
                  }
                  document.getElementById('tigst13').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst13').value = data2

              }
          });

      });

      $(document).on('click', '#item14', function () {
          select = $('#item14').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('rate14').value = data
                  document.getElementById('hsn14').value = data4


                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst14').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst14').value = data1
                  }
                  document.getElementById('tigst14').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst14').value = data2

              }
          });

      });

      $(document).on('click', '#item15', function () {
          select = $('#item15').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('rate15').value = data
                  document.getElementById('hsn15').value = data4


                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst15').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst15').value = data1
                  }
                  document.getElementById('tigst15').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst15').value = data2

              }
          });

      });

      $(document).on('click', '#item16', function () {
          select = $('#item16').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('rate16').value = data
                  document.getElementById('hsn16').value = data4


                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst16').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst16').value = data1
                  }
                  document.getElementById('tigst16').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst16').value = data2

              }
          });

      });

      $(document).on('click', '#item17', function () {
          select = $('#item17').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('rate17').value = data
                  document.getElementById('hsn17').value = data4


                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst17').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst17').value = data1
                  }
                  document.getElementById('tigst17').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst17').value = data2

              }
          });

      });

      $(document).on('click', '#item18', function () {
          select = $('#item18').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('rate18').value = data
                  document.getElementById('hsn18').value = data4


                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst18').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst18').value = data1
                  }
                  document.getElementById('tigst18').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst18').value = data2

              }
          });

      });

      $(document).on('click', '#item19', function () {
          select = $('#item19').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('rate19').value = data
                  document.getElementById('hsn19').value = data4


                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst19').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst19').value = data1
                  }
                  document.getElementById('tigst19').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst19').value = data2

              }
          });

      });

      $(document).on('click', '#item20', function () {
          select = $('#item20').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('rate20').value = data
                  document.getElementById('hsn20').value = data4


                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst20').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst20').value = data1
                  }
                  document.getElementById('tigst20').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst20').value = data2

              }
          });

      });

      $(document).on('click', '#item21', function () {
          select = $('#item21').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) 
              {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('rate21').value = data
                  document.getElementById('hsn21').value = data4

                  if (data3 == '{{ company.state }}') 
                  {
                      document.getElementById('tgst21').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst21').value = data1
                  }
                  document.getElementById('tigst21').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst21').value = data2

              }
          });

      });


  });
</script>





<!-- ................................................................................................................ -->
<!-- ................................................................................................................ -->
<!-- ...............................................................   ITEM TABLE 2.......................... -->

<script>
  $(document).ready(function () {
      var roinc = 0
      console.log("ajax");
      // var place = document.getElementById('pos').value;
      $(document).on('click', '#itemm1', function () {
          select = $('#itemm1').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('ratee1').value = data
                  document.getElementById('hsnn1').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst1').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst1').value = data1
                  }
                  document.getElementById('tigst1').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst1').value = data2
              }
          });
      });
      // console.log('pos:'+place_of_supply);
      $(document).on('click', '#itemm2', function () {
          select = $('#itemm2').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('ratee2').value = data
                  document.getElementById('hsnn2').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst2').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst2').value = data1
                  }
                  document.getElementById('tigst2').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst2').value = data2

              }
          });

      });

      $(document).on('click', '#itemm3', function () {
          select = $('#itemm3').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('ratee3').value = data
                  document.getElementById('hsnn3').value = data4
                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst3').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst3').value = data1
                  }
                  document.getElementById('tigst3').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst3').value = data2

              }
          });

      });

      $(document).on('click', '#itemm4', function () {
          select = $('#itemm4').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('ratee4').value = data
                  document.getElementById('hsnn4').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst4').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst4').value = data1
                  }
                  document.getElementById('tigst4').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst4').value = data2

              }
          });

      });

      $(document).on('click', '#itemm5', function () {
          select = $('#itemm5').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('ratee5').value = data
                  document.getElementById('hsnn5').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst5').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst5').value = data1
                  }
                  document.getElementById('tigst5').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst5').value = data2

              }
          });

      });

      $(document).on('click', '#itemm6', function () {
          select = $('#itemm6').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos

                  data4=response.hsn

                  document.getElementById('ratee6').value = data
                  document.getElementById('hsnn6').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst6').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst6').value = data1
                  }
                  document.getElementById('tigst6').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst6').value = data2

              }
          });

      });

      $(document).on('click', '#itemm7', function () {
          select = $('#itemm7').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('ratee7').value = data
                  document.getElementById('hsnn7').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst7').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst7').value = data1
                  }
                  document.getElementById('tigst7').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst7').value = data2

              }
          });

      });

      $(document).on('click', '#itemm8', function () {
          select = $('#itemm8').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('ratee8').value = data
                  document.getElementById('hsnn8').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst8').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst8').value = data1
                  }
                  document.getElementById('tigst8').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst8').value = data2

              }
          });

      });

      $(document).on('click', '#itemm9', function () {
          select = $('#itemm9').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('ratee9').value = data
                  document.getElementById('hsnn9').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst9').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst9').value = data1
                  }
                  document.getElementById('tigst9').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst9').value = data2

              }
          });

      });

      $(document).on('click', '#itemm10', function () {
          select = $('#itemm10').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('ratee10').value = data
                  document.getElementById('hsnn10').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst10').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst10').value = data1
                  }
                  document.getElementById('tigst10').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst10').value = data2

              }
          });

      });

      $(document).on('click', '#itemm11', function () {
          select = $('#itemm11').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('ratee11').value = data
                  document.getElementById('hsnn11').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst11').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst11').value = data1
                  }
                  document.getElementById('tigst11').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst11').value = data2

              }
          });

      });

      $(document).on('click', '#itemm12', function () {
          select = $('#itemm12').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('ratee12').value = data
                  document.getElementById('hsnn12').value = data4
                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst12').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst12').value = data1
                  }
                  document.getElementById('tigst12').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst12').value = data2

              }
          });

      });

      $(document).on('click', '#itemm13', function () {
          select = $('#itemm13').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('ratee13').value = data
                  document.getElementById('hsnn13').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst13').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst13').value = data1
                  }
                  document.getElementById('tigst13').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst13').value = data2

              }
          });

      });

      $(document).on('click', '#itemm14', function () {
          select = $('#itemm14').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

document.getElementById('ratee14').value = data
document.getElementById('hsnn14').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst14').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst14').value = data1
                  }
                  document.getElementById('tigst14').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst14').value = data2

              }
          });

      });

      $(document).on('click', '#itemm15', function () {
          select = $('#itemm15').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('ratee15').value = data
                  document.getElementById('hsnn15').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst15').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst15').value = data1
                  }
                  document.getElementById('tigst15').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst15').value = data2

              }
          });

      });

      $(document).on('click', '#itemm16', function () {
          select = $('#itemm16').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

document.getElementById('ratee16').value = data
document.getElementById('hsnn16').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst16').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst16').value = data1
                  }
                  document.getElementById('tigst16').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst16').value = data2

              }
          });

      });

      $(document).on('click', '#itemm17', function () {
          select = $('#itemm17').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('ratee17').value = data
                  document.getElementById('hsnn17').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst17').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst17').value = data1
                  }
                  document.getElementById('tigst17').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst17').value = data2

              }
          });

      });

      $(document).on('click', '#itemm18', function () {
          select = $('#itemm18').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('ratee18').value = data
                  document.getElementById('hsnn18').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst18').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst18').value = data1
                  }
                  document.getElementById('tigst18').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst18').value = data2

              }
          });

      });

      $(document).on('click', '#itemm19', function () {
          select = $('#itemm19').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('ratee19').value = data
                  document.getElementById('hsnn19').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst19').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst19').value = data1
                  }
                  document.getElementById('tigst19').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst19').value = data2

              }
          });

      });

      $(document).on('click', '#itemm20', function () {
          select = $('#itemm20').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('ratee20').value = data
                  document.getElementById('hsnn20').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst20').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst20').value = data1
                  }
                  document.getElementById('tigst20').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst20').value = data2

              }
          });

      });

      $(document).on('click', '#itemm21', function () {
          select = $('#itemm21').val();
          customer = $('#customer_sel').val();
          console.log(select);
          console.log(customer);
          $.ajax({
              type: "GET",
              url: "{% url 'itemdata_challan' %}",
              data: {
                  id: select,
                  cust: customer
              },
              success: function (response) {
                  console.log(response)
                  data = response.rate
                  data1 = response.gst
                  data2 = response.igst
                  data3 = response.pos
                  data4=response.hsn

                  document.getElementById('ratee21').value = data
                  document.getElementById('hsnn21').value = data4

                  if (data3 == '{{ company.state }}') {
                      document.getElementById('tgst21').innerHTML = data1 + ' % GST';
                      document.getElementById('tgst21').value = data1
                  }
                  document.getElementById('tigst21').innerHTML = data2 + ' % IGST';
                  document.getElementById('tigst21').value = data2

              }
          });

      });


  });
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>


{% endblock %}